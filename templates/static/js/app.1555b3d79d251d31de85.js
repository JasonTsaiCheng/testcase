webpackJsonp([1],{"2rK/":function(t,e,i){t.exports=i.p+"static/img/orbislogo.7af6b70.png"},"2yrU":function(t,e){},"3itp":function(t,e){},"87lX":function(t,e,i){"use strict";(function(t){var e,a=i("pFYg"),n=i.n(a);
/*!
 * jQuery Form Plugin
 * version: 3.51.0-2014.06.20
 * Requires jQuery v1.5 or later
 * Copyright (c) 2014 M. Alsup
 * Examples and documentation at: http://malsup.com/jquery/form/
 * Project repository: https://github.com/malsup/form
 * Dual licensed under the MIT and GPL licenses.
 * https://github.com/malsup/form#copyright-and-license
 */
e=function(t){var e={};e.fileapi=void 0!==t("<input type='file'/>").get(0).files,e.formdata=void 0!==window.FormData;var i=!!t.fn.prop;function a(e){var i=e.data;e.isDefaultPrevented()||(e.preventDefault(),t(e.target).ajaxSubmit(i))}function o(e){var i=e.target,a=t(i);if(!a.is("[type=submit],[type=image]")){var n=a.closest("[type=submit]");if(0===n.length)return;i=n[0]}var o=this;if(o.clk=i,"image"==i.type)if(void 0!==e.offsetX)o.clk_x=e.offsetX,o.clk_y=e.offsetY;else if("function"==typeof t.fn.offset){var r=a.offset();o.clk_x=e.pageX-r.left,o.clk_y=e.pageY-r.top}else o.clk_x=e.pageX-i.offsetLeft,o.clk_y=e.pageY-i.offsetTop;setTimeout(function(){o.clk=o.clk_x=o.clk_y=null},100)}function r(){if(t.fn.ajaxSubmit.debug){var e="[jquery.form] "+Array.prototype.join.call(arguments,"");window.console&&window.console.log?window.console.log(e):window.opera&&window.opera.postError&&window.opera.postError(e)}}t.fn.attr2=function(){if(!i)return this.attr.apply(this,arguments);var t=this.prop.apply(this,arguments);return t&&t.jquery||"string"==typeof t?t:this.attr.apply(this,arguments)},t.fn.ajaxSubmit=function(a){if(!this.length)return r("ajaxSubmit: skipping submit process - no element selected"),this;var n,o,s,l=this;"function"==typeof a?a={success:a}:void 0===a&&(a={}),n=a.type||this.attr2("method"),(s=(s="string"==typeof(o=a.url||this.attr2("action"))?t.trim(o):"")||window.location.href||"")&&(s=(s.match(/^([^#]+)/)||[])[1]),a=t.extend(!0,{url:s,success:t.ajaxSettings.success,type:n||t.ajaxSettings.type,iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},a);var c={};if(this.trigger("form-pre-serialize",[this,a,c]),c.veto)return r("ajaxSubmit: submit vetoed via form-pre-serialize trigger"),this;if(a.beforeSerialize&&!1===a.beforeSerialize(this,a))return r("ajaxSubmit: submit aborted via beforeSerialize callback"),this;var u=a.traditional;void 0===u&&(u=t.ajaxSettings.traditional);var d,p=[],m=this.formToArray(a.semantic,p);if(a.data&&(a.extraData=a.data,d=t.param(a.data,u)),a.beforeSubmit&&!1===a.beforeSubmit(m,this,a))return r("ajaxSubmit: submit aborted via beforeSubmit callback"),this;if(this.trigger("form-submit-validate",[m,this,a,c]),c.veto)return r("ajaxSubmit: submit vetoed via form-submit-validate trigger"),this;var h=t.param(m,u);d&&(h=h?h+"&"+d:d),"GET"==a.type.toUpperCase()?(a.url+=(a.url.indexOf("?")>=0?"&":"?")+h,a.data=null):a.data=h;var g=[];if(a.resetForm&&g.push(function(){l.resetForm()}),a.clearForm&&g.push(function(){l.clearForm(a.includeHidden)}),!a.dataType&&a.target){var v=a.success||function(){};g.push(function(e){var i=a.replaceTarget?"replaceWith":"html";t(a.target)[i](e).each(v,arguments)})}else a.success&&g.push(a.success);if(a.success=function(t,e,i){for(var n=a.context||this,o=0,r=g.length;o<r;o++)g[o].apply(n,[t,e,i||l,l])},a.error){var f=a.error;a.error=function(t,e,i){var n=a.context||this;f.apply(n,[t,e,i,l])}}if(a.complete){var _=a.complete;a.complete=function(t,e){var i=a.context||this;_.apply(i,[t,e,l])}}var b=t("input[type=file]:enabled",this).filter(function(){return""!==t(this).val()}).length>0,y="multipart/form-data",w=l.attr("enctype")==y||l.attr("encoding")==y,x=e.fileapi&&e.formdata;r("fileAPI :"+x);var F,k=(b||w)&&!x;!1!==a.iframe&&(a.iframe||k)?a.closeKeepAlive?t.get(a.closeKeepAlive,function(){F=V(m)}):F=V(m):F=(b||w)&&x?function(e){for(var i=new FormData,o=0;o<e.length;o++)i.append(e[o].name,e[o].value);if(a.extraData){var r=function(e){var i,n,o=t.param(e,a.traditional).split("&"),r=o.length,s=[];for(i=0;i<r;i++)o[i]=o[i].replace(/\+/g," "),n=o[i].split("="),s.push([decodeURIComponent(n[0]),decodeURIComponent(n[1])]);return s}(a.extraData);for(o=0;o<r.length;o++)r[o]&&i.append(r[o][0],r[o][1])}a.data=null;var s=t.extend(!0,{},t.ajaxSettings,a,{contentType:!1,processData:!1,cache:!1,type:n||"POST"});a.uploadProgress&&(s.xhr=function(){var e=t.ajaxSettings.xhr();return e.upload&&e.upload.addEventListener("progress",function(t){var e=0,i=t.loaded||t.position,n=t.total;t.lengthComputable&&(e=Math.ceil(i/n*100)),a.uploadProgress(t,i,n,e)},!1),e});s.data=null;var l=s.beforeSend;return s.beforeSend=function(t,e){a.formData?e.data=a.formData:e.data=i,l&&l.call(this,t,e)},t.ajax(s)}(m):t.ajax(a),l.removeData("jqxhr").data("jqxhr",F);for(var S=0;S<p.length;S++)p[S]=null;return this.trigger("form-submit-notify",[this,a]),this;function V(e){var o,s,c,u,d,m,h,g,v,f,_,b,y=l[0],w=t.Deferred();if(w.abort=function(t){g.abort(t)},e)for(s=0;s<p.length;s++)o=t(p[s]),i?o.prop("disabled",!1):o.removeAttr("disabled");if((c=t.extend(!0,{},t.ajaxSettings,a)).context=c.context||c,d="jqFormIO"+(new Date).getTime(),c.iframeTarget?(f=(m=t(c.iframeTarget)).attr2("name"))?d=f:m.attr2("name",d):(m=t('<iframe name="'+d+'" src="'+c.iframeSrc+'" />')).css({position:"absolute",top:"-1000px",left:"-1000px"}),h=m[0],g={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(e){var i="timeout"===e?"timeout":"aborted";r("aborting upload... "+i),this.aborted=1;try{h.contentWindow.document.execCommand&&h.contentWindow.document.execCommand("Stop")}catch(t){}m.attr("src",c.iframeSrc),g.error=i,c.error&&c.error.call(c.context,g,i,e),u&&t.event.trigger("ajaxError",[g,c,i]),c.complete&&c.complete.call(c.context,g,i)}},(u=c.global)&&0==t.active++&&t.event.trigger("ajaxStart"),u&&t.event.trigger("ajaxSend",[g,c]),c.beforeSend&&!1===c.beforeSend.call(c.context,g,c))return c.global&&t.active--,w.reject(),w;if(g.aborted)return w.reject(),w;(v=y.clk)&&(f=v.name)&&!v.disabled&&(c.extraData=c.extraData||{},c.extraData[f]=v.value,"image"==v.type&&(c.extraData[f+".x"]=y.clk_x,c.extraData[f+".y"]=y.clk_y));var x=1,F=2;function k(t){var e=null;try{t.contentWindow&&(e=t.contentWindow.document)}catch(t){r("cannot get iframe.contentWindow document: "+t)}if(e)return e;try{e=t.contentDocument?t.contentDocument:t.document}catch(i){r("cannot get iframe.contentDocument: "+i),e=t.document}return e}var S=t("meta[name=csrf-token]").attr("content"),V=t("meta[name=csrf-param]").attr("content");function C(){var e=l.attr2("target"),i=l.attr2("action"),a=l.attr("enctype")||l.attr("encoding")||"multipart/form-data";y.setAttribute("target",d),n&&!/post/i.test(n)||y.setAttribute("method","POST"),i!=c.url&&y.setAttribute("action",c.url),c.skipEncodingOverride||n&&!/post/i.test(n)||l.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"}),c.timeout&&(b=setTimeout(function(){_=!0,$(x)},c.timeout));var o=[];try{if(c.extraData)for(var s in c.extraData)c.extraData.hasOwnProperty(s)&&(t.isPlainObject(c.extraData[s])&&c.extraData[s].hasOwnProperty("name")&&c.extraData[s].hasOwnProperty("value")?o.push(t('<input type="hidden" name="'+c.extraData[s].name+'">').val(c.extraData[s].value).appendTo(y)[0]):o.push(t('<input type="hidden" name="'+s+'">').val(c.extraData[s]).appendTo(y)[0]));c.iframeTarget||m.appendTo("body"),h.attachEvent?h.attachEvent("onload",$):h.addEventListener("load",$,!1),setTimeout(function t(){try{var e=k(h).readyState;r("state = "+e),e&&"uninitialized"==e.toLowerCase()&&setTimeout(t,50)}catch(t){r("Server abort: ",t," (",t.name,")"),$(F),b&&clearTimeout(b),b=void 0}},15);try{y.submit()}catch(t){document.createElement("form").submit.apply(y)}}finally{y.setAttribute("action",i),y.setAttribute("enctype",a),e?y.setAttribute("target",e):l.removeAttr("target"),t(o).remove()}}V&&S&&(c.extraData=c.extraData||{},c.extraData[V]=S),c.forceSync?C():setTimeout(C,10);var D,T,j,L=50;function $(e){if(!g.aborted&&!j){if((T=k(h))||(r("cannot access response document"),e=F),e===x&&g)return g.abort("timeout"),void w.reject(g,"timeout");if(e==F&&g)return g.abort("server abort"),void w.reject(g,"error","server abort");if(T&&T.location.href!=c.iframeSrc||_){h.detachEvent?h.detachEvent("onload",$):h.removeEventListener("load",$,!1);var i,a="success";try{if(_)throw"timeout";var n="xml"==c.dataType||T.XMLDocument||t.isXMLDoc(T);if(r("isXml="+n),!n&&window.opera&&(null===T.body||!T.body.innerHTML)&&--L)return r("requeing onLoad callback, DOM not available"),void setTimeout($,250);var o=T.body?T.body:T.documentElement;g.responseText=o?o.innerHTML:null,g.responseXML=T.XMLDocument?T.XMLDocument:T,n&&(c.dataType="xml"),g.getResponseHeader=function(t){return{"content-type":c.dataType}[t.toLowerCase()]},o&&(g.status=Number(o.getAttribute("status"))||g.status,g.statusText=o.getAttribute("statusText")||g.statusText);var s=(c.dataType||"").toLowerCase(),l=/(json|script|text)/.test(s);if(l||c.textarea){var d=T.getElementsByTagName("textarea")[0];if(d)g.responseText=d.value,g.status=Number(d.getAttribute("status"))||g.status,g.statusText=d.getAttribute("statusText")||g.statusText;else if(l){var p=T.getElementsByTagName("pre")[0],v=T.getElementsByTagName("body")[0];p?g.responseText=p.textContent?p.textContent:p.innerText:v&&(g.responseText=v.textContent?v.textContent:v.innerText)}}else"xml"==s&&!g.responseXML&&g.responseText&&(g.responseXML=A(g.responseText));try{D=R(g,s,c)}catch(t){a="parsererror",g.error=i=t||a}}catch(t){r("error caught: ",t),a="error",g.error=i=t||a}g.aborted&&(r("upload aborted"),a=null),g.status&&(a=g.status>=200&&g.status<300||304===g.status?"success":"error"),"success"===a?(c.success&&c.success.call(c.context,D,"success",g),w.resolve(g.responseText,"success",g),u&&t.event.trigger("ajaxSuccess",[g,c])):a&&(void 0===i&&(i=g.statusText),c.error&&c.error.call(c.context,g,a,i),w.reject(g,"error",i),u&&t.event.trigger("ajaxError",[g,c,i])),u&&t.event.trigger("ajaxComplete",[g,c]),u&&!--t.active&&t.event.trigger("ajaxStop"),c.complete&&c.complete.call(c.context,g,a),j=!0,c.timeout&&clearTimeout(b),setTimeout(function(){c.iframeTarget?m.attr("src",c.iframeSrc):m.remove(),g.responseXML=null},100)}}}var A=t.parseXML||function(t,e){return window.ActiveXObject?((e=new ActiveXObject("Microsoft.XMLDOM")).async="false",e.loadXML(t)):e=(new DOMParser).parseFromString(t,"text/xml"),e&&e.documentElement&&"parsererror"!=e.documentElement.nodeName?e:null},z=t.parseJSON||function(t){return window.eval("("+t+")")},R=function(e,i,a){var n=e.getResponseHeader("content-type")||"",o="xml"===i||!i&&n.indexOf("xml")>=0,r=o?e.responseXML:e.responseText;return o&&"parsererror"===r.documentElement.nodeName&&t.error&&t.error("parsererror"),a&&a.dataFilter&&(r=a.dataFilter(r,i)),"string"==typeof r&&("json"===i||!i&&n.indexOf("json")>=0?r=z(r):("script"===i||!i&&n.indexOf("javascript")>=0)&&t.globalEval(r)),r};return w}},t.fn.ajaxForm=function(e){if((e=e||{}).delegation=e.delegation&&t.isFunction(t.fn.on),!e.delegation&&0===this.length){var i={s:this.selector,c:this.context};return!t.isReady&&i.s?(r("DOM not ready, queuing ajaxForm"),t(function(){t(i.s,i.c).ajaxForm(e)}),this):(r("terminating; zero elements found by selector"+(t.isReady?"":" (DOM not ready)")),this)}return e.delegation?(t(document).off("submit.form-plugin",this.selector,a).off("click.form-plugin",this.selector,o).on("submit.form-plugin",this.selector,e,a).on("click.form-plugin",this.selector,e,o),this):this.ajaxFormUnbind().bind("submit.form-plugin",e,a).bind("click.form-plugin",e,o)},t.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")},t.fn.formToArray=function(i,a){var n=[];if(0===this.length)return n;var o,r,s,l,c,u,d,p,m=this[0],h=this.attr("id"),g=i?m.getElementsByTagName("*"):m.elements;if(g&&!/MSIE [678]/.test(navigator.userAgent)&&(g=t(g).get()),h&&(o=t(':input[form="'+h+'"]').get()).length&&(g=(g||[]).concat(o)),!g||!g.length)return n;for(r=0,d=g.length;r<d;r++)if((l=(u=g[r]).name)&&!u.disabled)if(i&&m.clk&&"image"==u.type)m.clk==u&&(n.push({name:l,value:t(u).val(),type:u.type}),n.push({name:l+".x",value:m.clk_x},{name:l+".y",value:m.clk_y}));else if((c=t.fieldValue(u,!0))&&c.constructor==Array)for(a&&a.push(u),s=0,p=c.length;s<p;s++)n.push({name:l,value:c[s]});else if(e.fileapi&&"file"==u.type){a&&a.push(u);var v=u.files;if(v.length)for(s=0;s<v.length;s++)n.push({name:l,value:v[s],type:u.type});else n.push({name:l,value:"",type:u.type})}else null!==c&&void 0!==c&&(a&&a.push(u),n.push({name:l,value:c,type:u.type,required:u.required}));if(!i&&m.clk){var f=t(m.clk),_=f[0];(l=_.name)&&!_.disabled&&"image"==_.type&&(n.push({name:l,value:f.val()}),n.push({name:l+".x",value:m.clk_x},{name:l+".y",value:m.clk_y}))}return n},t.fn.formSerialize=function(e){return t.param(this.formToArray(e))},t.fn.fieldSerialize=function(e){var i=[];return this.each(function(){var a=this.name;if(a){var n=t.fieldValue(this,e);if(n&&n.constructor==Array)for(var o=0,r=n.length;o<r;o++)i.push({name:a,value:n[o]});else null!==n&&void 0!==n&&i.push({name:this.name,value:n})}}),t.param(i)},t.fn.fieldValue=function(e){for(var i=[],a=0,n=this.length;a<n;a++){var o=this[a],r=t.fieldValue(o,e);null===r||void 0===r||r.constructor==Array&&!r.length||(r.constructor==Array?t.merge(i,r):i.push(r))}return i},t.fieldValue=function(e,i){var a=e.name,n=e.type,o=e.tagName.toLowerCase();if(void 0===i&&(i=!0),i&&(!a||e.disabled||"reset"==n||"button"==n||("checkbox"==n||"radio"==n)&&!e.checked||("submit"==n||"image"==n)&&e.form&&e.form.clk!=e||"select"==o&&-1==e.selectedIndex))return null;if("select"==o){var r=e.selectedIndex;if(r<0)return null;for(var s=[],l=e.options,c="select-one"==n,u=c?r+1:l.length,d=c?r:0;d<u;d++){var p=l[d];if(p.selected){var m=p.value;if(m||(m=p.attributes&&p.attributes.value&&!p.attributes.value.specified?p.text:p.value),c)return m;s.push(m)}}return s}return t(e).val()},t.fn.clearForm=function(e){return this.each(function(){t("input,select,textarea",this).clearFields(e)})},t.fn.clearFields=t.fn.clearInputs=function(e){var i=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;return this.each(function(){var a=this.type,n=this.tagName.toLowerCase();i.test(a)||"textarea"==n?this.value="":"checkbox"==a||"radio"==a?this.checked=!1:"select"==n?this.selectedIndex=-1:"file"==a?/MSIE/.test(navigator.userAgent)?t(this).replaceWith(t(this).clone(!0)):t(this).val(""):e&&(!0===e&&/hidden/.test(a)||"string"==typeof e&&t(this).is(e))&&(this.value="")})},t.fn.resetForm=function(){return this.each(function(){("function"==typeof this.reset||"object"==n()(this.reset)&&!this.reset.nodeType)&&this.reset()})},t.fn.enable=function(t){return void 0===t&&(t=!0),this.each(function(){this.disabled=!t})},t.fn.selected=function(e){return void 0===e&&(e=!0),this.each(function(){var i=this.type;if("checkbox"==i||"radio"==i)this.checked=e;else if("option"==this.tagName.toLowerCase()){var a=t(this).parent("select");e&&a[0]&&"select-one"==a[0].type&&a.find("option").selected(!1),this.selected=e}})},t.fn.ajaxSubmit.debug=!1},"function"==typeof define&&i("nErl")?define(["jquery"],e):e(void 0!==t?t:window.Zepto)}).call(e,i("qqHy"))},"8Gpf":function(t,e){},BsKT:function(t,e,i){"use strict";(function(t){var a=i("woOf"),n=i.n(a),o=(i("YtJ0"),i("mtWM")),r=i.n(o),s=i("P9l9"),l=i("O2WP"),c=i("u4WU"),u=(i("87lX"),l.a.url);e.a={name:"undiagnosed",created:function(){console.log("host",u);var t=this.$store.state.page_info;t.page_size&&t.currentPage?(console.log("111122",t.page_size,t.currentPage),this.page_size=t.page_size,this.currentPage=t.currentPage,this.get_patients(t.currentPage,t.page_size)):(console.log("222211",c.a.getCookie("hospital_id")),this.get_patients(1,10))},mounted:function(){var t=window.innerWidth-250;console.log(t),document.getElementById("rightNav").style.width=t+"px"},methods:{refresh:function(){this.currentPage=1;var t=this.page_size,e=this.inputVal;this.otherDate?(this.get_patients_by_rules(1,t,this.dateValue,e),console.log("otherdate")):(this.get_patients_by_rules(1,t,"",e),console.log("total"))},delieverPageAndSize:function(){var t=this.currentPage,e=this.page_size,i={};i.currentPage=t,i.page_size=e,this.$store.commit("rememberPageAndSize",i)},handleSizeChange:function(t){var e=t;this.page_size=e,this.currentPage=1;var i=this.currentPage,a=this.inputVal;this.delieverPageAndSize(),console.log(i,e),this.otherDate?(this.get_patients_by_rules(i,e,this.dateValue,a),console.log("otherdate")):(this.get_patients_by_rules(i,e,"",a),console.log("page_size total"))},handleCurrentChange:function(t){var e=t,i=this.page_size,a=this.inputVal;console.log(e,i),this.delieverPageAndSize(),this.otherDate?(this.get_patients_by_rules(e,i,this.dateValue,a),console.log("otherdate")):(this.get_patients_by_rules(e,i,"",a),console.log("pagination total"))},turnBlue:function(t){"isActive1"==t.currentTarget.id&&(console.log("isActive1"),this.isActive1=!0,this.isActive4=!1,this.otherDate=!1,this.dateValue="",this.refresh())},get_patients:function(t,e,i,a){var n=this,o=c.a.getCookie("hospital_id");r.a.get(u+"/patients/?p="+t+"&page_size="+e+"&hospital_id="+o+"&ordering=-apply_time&status=0").then(function(t){console.log(t),n.tableData=t.data.results,n.totalNum=t.data.count}).catch(function(t){console.log(t)})},get_patients_by_rules:function(t,e,i,a){var n=this,o=c.a.getCookie("hospital_id");r.a.get(u+"/patients/?p="+t+"&page_size="+e+"&ordering=-apply_time&apply_time="+i+"&hospital_id="+o+"&search="+a+"&status=0").then(function(t){console.log(t),n.tableData=t.data.results,n.totalNum=t.data.count}).catch(function(t){console.log(t)})},selectDate:function(){this.isActive1=!1,this.isActive4=!0,this.otherDate=!0;var t=new Date(this.dateValue),e=t.getFullYear(),i=t.getMonth()+1,a=t.getDate();i>=1&&i<=9&&(i="0"+i),a>=0&&a<=9&&(a="0"+a);var n=e+"-"+i+"-"+a;this.dateValue=n,this.currentPage=1;var o=this.inputVal;console.log(this.dateValue),console.log(o),this.get_patients_by_rules(1,this.page_size,n,o)},searchBtn:function(){console.log("searchBtn"),this.currentPage=1,this.get_patients_by_rules(1,this.page_size,this.dateValue,this.inputVal)},formatSex:function(t){return"1"===t.patient_gender?"男":"0"===t.patient_gender?"女":"未知"},formatStatus:function(t){return"0"===t.status?"未诊断":"2"===t.status?"已诊断":"诊断中"},formatButton:function(t){return"1"===t.pic_upload||"0"!==t.pic_upload},handleEdit:function(t,e){console.log("qqqqq",t,e);var i=e.historyDisease;console.log(i),i[0]?(console.log("有既往史"),this.editFormVisible=!0,this.editForm=n()({},e),this.editFormJwsForm=i[0],this.editFormLeftDiopterValue=i[0].left_diopter,this.editFormRightDiopterValue=i[0].right_diopter,this.editForm.jwsExist=1,this.editFormjwsVisible=!0,this.radio=3):(console.log("无既往史"),this.editFormVisible=!0,this.editForm=n()({},e),this.editForm.jwsExist=0,this.editFormjwsVisible=!1,this.radio=6)},handleAdd:function(){console.log("this.addForm.jwsVisible",this.addForm.jwsVisible),this.addFormVisible=!0,this.addForm={patient_name:"",patient_gender:0,patient_age:0,patient_tel:"",address:"",jwsRadio:0,genderRadio:0,jwsVisible:!1,jwsExist:0}},checkIsDiagnoseAgain:function(){var t=this,e=n()({},this.addForm);Object(s.b)(e).then(function(e){console.log(1111,e),"0"==e?console.log("查无此人"):(console.log("resres",e),t.$alert("经系统检测，该名患者已存在，确认历史信息无误后可直接提交","温馨提示",{confirmButtonText:"确定",callback:function(i){console.log(e),t.addFormVisible=!1,t.editFormVisible=!0,t.editForm=e.fields,e.his_fields?(t.editFormJwsForm=e.his_fields,t.editFormLeftDiopterValue=e.his_fields.left_diopter,t.editFormRightDiopterValue=e.his_fields.right_diopter,t.editForm.jwsExist=1,t.editFormjwsVisible=!0,t.radio=3):(t.radio=6,t.editjws()),t.editForm.patient_id=e.patient_id,t.editForm.diagnose_again="1",t.$refs.addForm.resetFields()}}))})},addSubmit:function(){var t=this;this.$refs.addForm.validate(function(e){e&&t.$confirm("确认提交吗？","提示",{}).then(function(){t.addLoading=!0,console.log("this.jwsForm",t.jwsForm),console.log(t.leftDiopterValue,t.rightDiopterValue);var e=t.jwsForm,i={};""!==t.leftDiopterValue&&(e.left_diopter=t.leftDiopterValue),""!==t.rightDiopterValue&&(e.right_diopter=t.rightDiopterValue),i.jwsInfo=e,i.basicInfo=t.addForm,console.log("submitInfo",i);var a=n()({},i);a.basicInfo.user_token=c.a.getCookie("token"),console.log("hhhhh",a),Object(s.a)(a).then(function(e){t.addLoading=!1,t.$message({message:"提交成功",type:"success"}),t.$refs.addForm.resetFields(),t.addFormVisible=!1,t.refresh()})})})},handleDel:function(t,e){var i=this;this.$confirm("确认删除该记录吗?","提示",{type:"warning"}).then(function(){var t={id:e.patient_id};Object(s.g)(t).then(function(t){console.log(1111,t),0===t?i.$alert("经系统检测，该名患者已有诊断记录，无法删除","温馨提示",{confirmButtonText:"确定",callback:function(t){console.log(t)}}):(i.$message({message:"删除成功",type:"success"}),i.refresh())})}).catch(function(){})},jwsClick:function(){var t=this.addForm.jwsExist;0===t?(this.addForm.jwsVisible=!1,this.jwsForm={},this.leftDiopterValue="",this.rightDiopterValue=""):1===t&&(this.addForm.jwsVisible=!0)},editjws:function(){var t=this.radio;console.log(t),3===t?(this.editForm.jwsExist=1,this.editFormjwsVisible=!0):6===t&&(this.editFormjwsVisible=!1,this.editFormJwsForm={},this.editFormRightDiopterValue="",this.editFormLeftDiopterValue="",this.editForm.jwsExist=0)},editSubmit:function(){var t=this;this.$refs.editForm.validate(function(e){e&&t.$confirm("确认提交吗？","提示",{}).then(function(){t.editLoading=!0,console.log(123456789);var e=t.editFormJwsForm;console.log(t.editForm);var i={};""!==t.editFormLeftDiopterValue&&(e.left_diopter=t.editFormLeftDiopterValue),""!==t.editFormRightDiopterValue&&(e.right_diopter=t.editFormRightDiopterValue),i.jwsInfo=e,i.basicInfo=t.editForm,console.log("13256",i);var a=n()({},i);console.log("para",a),Object(s.d)(a).then(function(e){t.editLoading=!1,t.$message({message:"提交成功",type:"success"}),t.$refs.editForm.resetFields(),t.editFormVisible=!1,t.refresh()})})})},clickReport:function(t){var e={};e.page_size=this.page_size,e.currentPage=this.currentPage,e.patient_name=t.patient_name,e.patient_gender=t.patient_gender,e.patient_age=t.patient_age,e.patient_id=t.patient_id,e.diagnose_record=t.diagnose_record,e.apply_time=t.apply_time,e.picture=t.picture,this.$store.commit("clickReport",e)},clickToDiagnose:function(t,e){var i=this;this.editForm=n()({},e);var a={};a.patient_id=this.editForm.patient_id,a.doctor=c.a.getCookie("name");var o=n()({},a);Object(s.c)(o).then(function(t){console.log(1111,t),0===t?i.$alert("该名患者正在被诊断，您暂时无法诊断","温馨提示",{confirmButtonText:"确定",callback:function(t){console.log(t)}}):i.clickReport(i.editForm)})},uploadPicture:function(){document.getElementById("fileToUpload").click()},get_file_num:function(){return document.getElementById("fileToUpload").files.length},uploadPic:function(){var e=this.$loading({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});if(this.get_file_num()>2)return alert("单次上传不可超过2张"),!1;var i={url:u+"operation/web_upload_picture/",data:{userName:c.a.getCookie("name")},type:"post",dataType:"json",cache:!1,processData:!1,contentType:!1,success:function(t,i,a){console.log("result",t),1===t?(e.close(),alert("上传失败")):(e.close(),alert("上传成功"),this.refresh)},error:function(){e.close(),alert("建议上传图片小于100M或者检查网络情况！")}};t("#jvForm").ajaxSubmit(i)}},data:function(){return{page_info:{},tableData:[],dateValue:"",isActive1:!0,isActive4:!1,currentPage:1,inputVal:"",input:"",page_size:10,totalNum:30,otherDate:!1,pic_upload:!1,editFormjwsVisible:!1,radio:3,pickerOptions:{disabledDate:function(t){return t.getTime()>Date.now()},shortcuts:[{text:"今天",onClick:function(t){t.$emit("pick",new Date)}},{text:"昨天",onClick:function(t){var e=new Date;e.setTime(e.getTime()-864e5),t.$emit("pick",e)}},{text:"一周前",onClick:function(t){var e=new Date;e.setTime(e.getTime()-6048e5),t.$emit("pick",e)}}]},editFormVisible:!1,editLoading:!1,editFormRules:{patient_name:[{required:!0,message:"请输入姓名",trigger:"blur"}],patient_tel:[{required:!0,message:"请输入手机号",trigger:"blur"}]},editForm:{patient_id:0,patient_name:"测试",patient_gender:"0",patient_age:0,patient_tel:18888888888,birth:"",jwsRadio:0,jwsExist:0,jwsVisible:!1,address:"",picture:[]},addFormVisible:!1,addLoading:!1,addFormRules:{patient_name:[{required:!0,message:"请输入姓名",trigger:"blur"}],patient_tel:[{required:!0,message:"请输入手机号",trigger:"blur"}]},addForm:{patient_id:0,patient_name:"张三",patient_gender:1,patient_age:0,patient_tel:"",address:"",jwsExist:0,jwsVisible:!1,jwsRadio:0,genderRadio:0},jwsForm:{other:"",DM_year:"",HTN_year:"",HPL_year:"",pregnant_weeks:""},editFormJwsForm:{other:"",DM_year:"",HTN_year:"",HPL_year:"",pregnant_weeks:""},leftDiopter:[{value:"0",label:"正视"},{value:"1",label:"低度近视(75~300)"},{value:"2",label:"中度近视(75~300)"},{value:"3",label:"高度近视(75~300)"},{value:"4",label:"远视"}],rightDiopter:[{value:"0",label:"正视"},{value:"1",label:"低度近视(75~300)"},{value:"2",label:"中度近视(75~300)"},{value:"3",label:"高度近视(75~300)"},{value:"4",label:"远视"}],editFormLeftDiopter:[{value:"0",label:"正视"},{value:"1",label:"低度近视(75~300)"},{value:"2",label:"中度近视(75~300)"},{value:"3",label:"高度近视(75~300)"},{value:"4",label:"远视"}],editFormRightDiopter:[{value:"0",label:"正视"},{value:"1",label:"低度近视(75~300)"},{value:"2",label:"中度近视(75~300)"},{value:"3",label:"高度近视(75~300)"},{value:"4",label:"远视"}],leftDiopterValue:"",rightDiopterValue:"",editFormLeftDiopterValue:"",editFormRightDiopterValue:""}}}}).call(e,i("qqHy"))},NHnr:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("7+uW"),n=i("YtJ0"),o={name:"orbis_leftNav",store:n.a,methods:{handleOpen:function(t,e){console.log(t,e)},handleClose:function(t,e){console.log(t,e)},add:function(){console.log("add Event from leftNav"),n.a.commit("increase")}},mounted:function(){var t=window.innerHeight;console.log(t),document.getElementById("leftNav").style.height=t+"px"}},r={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"leftNav",attrs:{id:"leftNav"}},[a("el-container",[a("el-header",{staticClass:"logo"},[a("img",{attrs:{id:"logoImg",src:i("2rK/"),alt:""}}),t._v("\n      OrbisBioTech\n    ")])],1),t._v(" "),a("el-container",[a("el-menu",{staticClass:"el-menu-vertical-demo",attrs:{"default-active":"1-1","background-color":"#2F4050","text-color":"#fff"},on:{open:t.handleOpen,close:t.handleClose}},[a("el-submenu",{attrs:{index:"1"}},[a("template",{slot:"title"},[a("i",{staticClass:"icon iconfont icon-yiliao_"}),t._v(" "),a("span",[t._v("PACS")])]),t._v(" "),a("el-menu-item",{attrs:{id:"undiagnosed",index:"1-1"},on:{click:function(e){return t.$store.commit("clickUndiagnosed")}}},[t._v("未诊列表")]),t._v(" "),a("el-menu-item",{attrs:{id:"diagnosed",index:"1-2"},on:{click:function(e){return t.$store.commit("clickDiagnosed")}}},[t._v("已诊列表")])],2),t._v(" "),a("el-menu-item",{attrs:{index:"3"},on:{click:function(e){return t.$store.commit("clickTransform")}}},[a("i",{staticClass:"icon iconfont icon-zhuanhuan"}),t._v(" "),a("span",{attrs:{slot:"title"},slot:"title"},[t._v("病患转化")])]),t._v(" "),a("el-menu-item",{attrs:{index:"5"},on:{click:function(e){return t.$store.commit("clickStatistics")}}},[a("i",{staticClass:"icon iconfont icon-shuju1"}),t._v(" "),a("span",{attrs:{slot:"title"},slot:"title"},[t._v("数据统计")])])],1)],1)],1)},staticRenderFns:[]};var s=i("VU/8")(o,r,!1,function(t){i("2yrU")},"data-v-fdeee632",null).exports,l={name:"topHeader",created:function(){var t=this.$store.state.user_info;this.user_info=t,console.log("user_info",t)},methods:{logout:function(){var t=this;this.$confirm("确定退出?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$store.commit("logout")}).catch(function(t){console.log(t)})}},data:function(){return{user_info:{}}}},c={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"topHeader"},[[i("div",[i("el-row",[i("el-col",{attrs:{span:21}},[t._v(" ")]),t._v(" "),i("el-col",{attrs:{span:3}},[i("a",{attrs:{href:"javascript:;"}},[i("i",{staticClass:"el-icon-s-custom"}),t._v(t._s(t.user_info.name))]),t._v("\n              \n          "),i("a",{attrs:{href:"javascript:;"},on:{click:t.logout}},[i("i",{staticClass:"el-icon-switch-button"},[t._v("退出")])])])],1)],1)]],2)},staticRenderFns:[]};var u=i("VU/8")(l,c,!1,function(t){i("8Gpf")},"data-v-11522492",null).exports,d=i("BsKT"),p={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"undiagnosed"},[i("el-row",[i("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[i("el-breadcrumb-item",{attrs:{to:{path:"/"}}},[t._v("PACS")]),t._v(" "),i("el-breadcrumb-item",[t._v("未诊列表")])],1)],1),t._v(" "),i("el-row",{staticClass:"operationNew"},[i("el-col",{class:{active:t.isActive1},attrs:{span:2}},[i("a",{attrs:{id:"isActive1",href:"javascript:;"},on:{click:t.turnBlue}},[t._v("全部")])]),t._v(" "),i("el-col",{staticClass:"timepicker",class:{active:t.isActive4},attrs:{span:3}},[i("a",{attrs:{id:"isActive4",href:"javascript:;"},on:{click:function(t){}}},[i("el-date-picker",{attrs:{align:"right",type:"date",placeholder:"选择日期","picker-options":t.pickerOptions},on:{change:t.selectDate},model:{value:t.dateValue,callback:function(e){t.dateValue=e},expression:"dateValue"}})],1)]),t._v(" "),i("el-col",{attrs:{span:6}},[t._v(" ")]),t._v(" "),i("el-col",{attrs:{span:2}},[i("el-button",{attrs:{type:"primary"},on:{click:t.uploadPicture}},[t._v("上传照片"),i("i",{staticClass:"el-icon-upload el-icon--right"})])],1),t._v(" "),i("el-col",{attrs:{span:2}},[i("el-button",{attrs:{type:"primary"},on:{click:t.handleAdd}},[t._v("添加患者"),i("i",{staticClass:"el-icon-upload el-icon--right"})])],1),t._v(" "),i("div",{staticStyle:{"text-align":"center"}},[i("el-col",{attrs:{span:2}},[i("a",{attrs:{href:"javascript:;"},on:{click:t.refresh}},[i("i",{staticClass:"icon iconfont icon-shuaxin1"}),t._v("刷新")])]),t._v(" "),i("el-col",{attrs:{span:5}},[i("el-input",{attrs:{placeholder:"输入患者姓名/手机号/身份证号 可模糊检索"},model:{value:t.inputVal,callback:function(e){t.inputVal=e},expression:"inputVal"}})],1),t._v(" "),i("el-col",{attrs:{span:2}},[i("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.searchBtn}},[t._v("搜索")])],1)],1)],1),t._v(" "),i("el-row",[i("form",{staticStyle:{width:"auto"},attrs:{action:"",method:"POST",id:"jvForm",enctype:"multipart/form-data"}},[i("input",{staticStyle:{display:"none"},attrs:{type:"file",name:"patient_img",accept:"image/*",multiple:"multiple",id:"fileToUpload"},on:{change:t.uploadPic}})])]),t._v(" "),i("el-row",{staticClass:"dataZone"},[[i("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,stripe:""}},[i("el-table-column",{attrs:{prop:"patient_id",label:"患者编号"}}),t._v(" "),i("el-table-column",{attrs:{prop:"patient_name",label:"姓名"}}),t._v(" "),i("el-table-column",{attrs:{prop:"patient_gender",label:"性别",formatter:t.formatSex}}),t._v(" "),i("el-table-column",{attrs:{prop:"patient_age",label:"年龄"}}),t._v(" "),i("el-table-column",{attrs:{prop:"patient_tel",label:"手机号"}}),t._v(" "),i("el-table-column",{attrs:{prop:"apply_time",label:"录入时间"}}),t._v(" "),i("el-table-column",{attrs:{prop:"status",label:"状态",formatter:t.formatStatus}}),t._v(" "),i("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.formatButton(e.row)?i("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-first-aid-kit",circle:""},on:{click:function(i){return t.clickToDiagnose(e.$index,e.row)}}}):t._e(),t._v(" "),t.formatButton(e.row)?t._e():i("el-button",{attrs:{type:"danger",size:"small",icon:"el-icon-delete",circle:""},on:{click:function(i){return t.handleDel(e.$index,e.row)}}}),t._v(" "),i("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-edit",circle:""},on:{click:function(i){return t.handleEdit(e.$index,e.row)}}})]}}])})],1)]],2),t._v(" "),i("el-row",{staticClass:"pagination"},[i("el-pagination",{attrs:{"current-page":t.currentPage,"page-sizes":[5,10],"page-size":t.page_size,layout:"total, sizes, prev, pager, next, jumper",total:t.totalNum},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange,"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e}}})],1),t._v(" "),i("el-dialog",{attrs:{title:"新增",visible:t.addFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(e){t.addFormVisible=e}},model:{value:t.addFormVisible,callback:function(e){t.addFormVisible=e},expression:"addFormVisible"}},[i("el-form",{ref:"addForm",attrs:{model:t.addForm,"label-width":"80px",rules:t.addFormRules}},[i("el-form-item",{staticStyle:{width:"25%"},attrs:{label:"姓名",prop:"patient_name"}},[i("el-input",{attrs:{"auto-complete":"off"},model:{value:t.addForm.patient_name,callback:function(e){t.$set(t.addForm,"patient_name",e)},expression:"addForm.patient_name"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"手机号",prop:"patient_tel"}},[i("el-input",{staticStyle:{width:"25%"},attrs:{type:"text",placeholder:"手机号",oninput:"value=value.replace(/[^\\d]/g,'')",maxlength:"11","show-word-limit":""},on:{blur:t.checkIsDiagnoseAgain},model:{value:t.addForm.patient_tel,callback:function(e){t.$set(t.addForm,"patient_tel",e)},expression:"addForm.patient_tel"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"性别"}},[i("el-radio-group",{model:{value:t.addForm.patient_gender,callback:function(e){t.$set(t.addForm,"patient_gender",e)},expression:"addForm.patient_gender"}},[i("el-radio",{staticClass:"radio",attrs:{label:1},model:{value:t.addForm.genderRadio,callback:function(e){t.$set(t.addForm,"genderRadio",e)},expression:"addForm.genderRadio"}},[t._v("男")]),t._v(" "),i("el-radio",{staticClass:"radio",attrs:{label:0},model:{value:t.addForm.genderRadio,callback:function(e){t.$set(t.addForm,"genderRadio",e)},expression:"addForm.genderRadio"}},[t._v("女")])],1)],1),t._v(" "),i("el-form-item",{attrs:{label:"年龄"}},[i("el-input-number",{staticStyle:{width:"25%"},attrs:{oninput:"value=value.replace(/[^\\d]/g,'')",min:0,max:200},model:{value:t.addForm.patient_age,callback:function(e){t.$set(t.addForm,"patient_age",e)},expression:"addForm.patient_age"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"既往史"}},[i("el-radio-group",{attrs:{onclick:t.jwsClick()},model:{value:t.addForm.jwsExist,callback:function(e){t.$set(t.addForm,"jwsExist",e)},expression:"addForm.jwsExist"}},[i("el-radio",{staticClass:"radio",attrs:{label:1},model:{value:t.addForm.jwsRadio,callback:function(e){t.$set(t.addForm,"jwsRadio",e)},expression:"addForm.jwsRadio"}},[t._v("有")]),t._v(" "),i("el-radio",{staticClass:"radio",attrs:{label:0},model:{value:t.addForm.jwsRadio,callback:function(e){t.$set(t.addForm,"jwsRadio",e)},expression:"addForm.jwsRadio"}},[t._v("无")])],1),t._v(" "),i("br"),t._v(" "),t.addForm.jwsVisible?i("el-form-item",[i("span",[t._v("糖尿病:")]),i("el-input-number",{attrs:{"controls-position":"right",size:"mini",min:0,max:100},model:{value:t.jwsForm.DM_year,callback:function(e){t.$set(t.jwsForm,"DM_year",e)},expression:"jwsForm.DM_year"}}),t._v("年\n                        \n        "),i("span",[t._v("高血压:")]),i("el-input-number",{attrs:{"controls-position":"right",size:"mini",min:0,max:100},model:{value:t.jwsForm.HTN_year,callback:function(e){t.$set(t.jwsForm,"HTN_year",e)},expression:"jwsForm.HTN_year"}}),t._v("年\n        "),i("br"),t._v(" "),i("span",[t._v("高血脂:")]),i("el-input-number",{attrs:{"controls-position":"right",size:"mini",min:0,max:100},model:{value:t.jwsForm.HPL_year,callback:function(e){t.$set(t.jwsForm,"HPL_year",e)},expression:"jwsForm.HPL_year"}}),t._v("年\n                        \n        "),i("span",[t._v("   妊娠:")]),i("el-input-number",{attrs:{"controls-position":"right",size:"mini",min:0,max:100},model:{value:t.jwsForm.pregnant_weeks,callback:function(e){t.$set(t.jwsForm,"pregnant_weeks",e)},expression:"jwsForm.pregnant_weeks"}}),t._v("周\n        "),i("br"),t._v(" "),i("span",[t._v("其他:   ")]),i("el-input",{staticStyle:{width:"410px"},attrs:{size:"mini",placeholder:"请输入内容",clearable:""},model:{value:t.jwsForm.other,callback:function(e){t.$set(t.jwsForm,"other",e)},expression:"jwsForm.other"}}),t._v(" "),i("br"),t._v(" "),i("span",[t._v("屈光度:")]),t._v("\n        左眼:"),[i("el-select",{staticStyle:{width:"150px"},attrs:{size:"mini",clearable:"",placeholder:"请选择"},model:{value:t.leftDiopterValue,callback:function(e){t.leftDiopterValue=e},expression:"leftDiopterValue"}},t._l(t.leftDiopter,function(t){return i("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],t._v("\n                 右眼:"),[i("el-select",{staticStyle:{width:"150px"},attrs:{size:"mini",clearable:"",placeholder:"请选择"},model:{value:t.rightDiopterValue,callback:function(e){t.rightDiopterValue=e},expression:"rightDiopterValue"}},t._l(t.rightDiopter,function(t){return i("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)]],2):t._e()],1),t._v(" "),i("br"),t._v(" "),i("el-form-item",{attrs:{label:"地址"}},[i("el-input",{attrs:{type:"textarea"},model:{value:t.addForm.address,callback:function(e){t.$set(t.addForm,"address",e)},expression:"addForm.address"}})],1)],1),t._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{nativeOn:{click:function(e){t.addFormVisible=!1}}},[t._v("取消")]),t._v(" "),i("el-button",{attrs:{type:"primary",loading:t.addLoading},nativeOn:{click:function(e){return t.addSubmit(e)}}},[t._v("提交")])],1)],1),t._v(" "),i("el-dialog",{attrs:{title:"编辑",visible:t.editFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(e){t.editFormVisible=e}},model:{value:t.editFormVisible,callback:function(e){t.editFormVisible=e},expression:"editFormVisible"}},[i("el-form",{ref:"editForm",attrs:{model:t.editForm,"label-width":"80px",rules:t.editFormRules}},[i("el-form-item",{staticStyle:{width:"25%"},attrs:{label:"姓名",prop:"patient_name"}},[i("el-input",{attrs:{"auto-complete":"off"},model:{value:t.editForm.patient_name,callback:function(e){t.$set(t.editForm,"patient_name",e)},expression:"editForm.patient_name"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"手机号",prop:"patient_tel"}},[i("el-input",{staticStyle:{width:"25%"},attrs:{type:"text",placeholder:"手机号",oninput:"value=value.replace(/[^\\d]/g,'')",maxlength:"11","show-word-limit":""},model:{value:t.editForm.patient_tel,callback:function(e){t.$set(t.editForm,"patient_tel",e)},expression:"editForm.patient_tel"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"性别"}},[i("el-radio-group",{model:{value:t.editForm.patient_gender,callback:function(e){t.$set(t.editForm,"patient_gender",e)},expression:"editForm.patient_gender"}},[i("el-radio",{staticClass:"radio",attrs:{label:"1"}},[t._v("男")]),t._v(" "),i("el-radio",{staticClass:"radio",attrs:{label:"0"}},[t._v("女")])],1)],1),t._v(" "),i("el-form-item",{attrs:{label:"年龄"}},[i("el-input-number",{staticStyle:{width:"25%"},attrs:{oninput:"value=value.replace(/[^\\d]/g,'')",min:0,max:200},model:{value:t.editForm.patient_age,callback:function(e){t.$set(t.editForm,"patient_age",e)},expression:"editForm.patient_age"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"既往史"}},[[i("el-radio-group",{attrs:{onchange:t.editjws()},model:{value:t.radio,callback:function(e){t.radio=e},expression:"radio"}},[i("el-radio",{attrs:{label:3}},[t._v("有")]),t._v(" "),i("el-radio",{attrs:{label:6}},[t._v("无")])],1)],t._v(" "),i("br"),t._v(" "),t.editFormjwsVisible?i("el-form-item",[i("span",[t._v("糖尿病:")]),i("el-input-number",{attrs:{"controls-position":"right",size:"mini",min:0,max:100},model:{value:t.editFormJwsForm.DM_year,callback:function(e){t.$set(t.editFormJwsForm,"DM_year",e)},expression:"editFormJwsForm.DM_year"}}),t._v("年\n                            \n            "),i("span",[t._v("高血压:")]),i("el-input-number",{attrs:{"controls-position":"right",size:"mini",min:0,max:100},model:{value:t.editFormJwsForm.HTN_year,callback:function(e){t.$set(t.editFormJwsForm,"HTN_year",e)},expression:"editFormJwsForm.HTN_year"}}),t._v("年\n            "),i("br"),t._v(" "),i("span",[t._v("高血脂:")]),i("el-input-number",{attrs:{"controls-position":"right",size:"mini",min:0,max:100},model:{value:t.editFormJwsForm.HPL_year,callback:function(e){t.$set(t.editFormJwsForm,"HPL_year",e)},expression:"editFormJwsForm.HPL_year"}}),t._v("年\n                            \n            "),i("span",[t._v("   妊娠:")]),i("el-input-number",{attrs:{"controls-position":"right",size:"mini",min:0,max:100},model:{value:t.editFormJwsForm.pregnant_weeks,callback:function(e){t.$set(t.editFormJwsForm,"pregnant_weeks",e)},expression:"editFormJwsForm.pregnant_weeks"}}),t._v("周\n            "),i("br"),t._v(" "),i("span",[t._v("其他:   ")]),i("el-input",{staticStyle:{width:"410px"},attrs:{size:"mini",placeholder:"请输入内容",clearable:""},model:{value:t.editFormJwsForm.other,callback:function(e){t.$set(t.editFormJwsForm,"other",e)},expression:"editFormJwsForm.other"}}),t._v(" "),i("br"),t._v(" "),i("span",[t._v("屈光度:")]),t._v("\n            左眼:"),[i("el-select",{staticStyle:{width:"150px"},attrs:{size:"mini",clearable:"",placeholder:"请选择"},model:{value:t.editFormLeftDiopterValue,callback:function(e){t.editFormLeftDiopterValue=e},expression:"editFormLeftDiopterValue"}},t._l(t.editFormLeftDiopter,function(t){return i("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],t._v("\n                     右眼:"),[i("el-select",{staticStyle:{width:"150px"},attrs:{size:"mini",clearable:"",placeholder:"请选择"},model:{value:t.editFormRightDiopterValue,callback:function(e){t.editFormRightDiopterValue=e},expression:"editFormRightDiopterValue"}},t._l(t.editFormLeftDiopter,function(t){return i("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)]],2):t._e()],2),t._v(" "),i("br"),t._v(" "),i("el-form-item",{attrs:{label:"地址"}},[i("el-input",{attrs:{type:"textarea"},model:{value:t.editForm.address,callback:function(e){t.$set(t.editForm,"address",e)},expression:"editForm.address"}})],1)],1),t._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{nativeOn:{click:function(e){t.editFormVisible=!1}}},[t._v("取消")]),t._v(" "),i("el-button",{attrs:{type:"primary",loading:t.editLoading},nativeOn:{click:function(e){return t.editSubmit(e)}}},[t._v("提交")])],1)],1)],1)},staticRenderFns:[]};var m=function(t){i("OidG")},h=i("VU/8")(d.a,p,!1,m,"data-v-1c505d56",null).exports,g=i("woOf"),v=i.n(g),f=i("mtWM"),_=i.n(f),b=i("P9l9"),y=i("u4WU"),w=i("O2WP"),x=w.a.url,F={name:"undiagnosed",created:function(){this.get_patients(1,10)},methods:{refresh:function(){this.currentPage=1;var t=this.page_size,e=this.inputVal;this.otherDate?(this.get_patients_by_rules(1,t,this.dateValue,e),console.log("otherdate")):(this.get_patients_by_rules(1,t,"",e),console.log("total"))},handleSizeChange:function(t){var e=t;this.page_size=e,this.currentPage=1;var i=this.currentPage,a=this.inputVal;console.log(i,e),this.otherDate?(this.get_patients_by_rules(i,e,this.dateValue,a),console.log("otherdate")):(this.get_patients_by_rules(i,e,"",a),console.log("page_size total"))},handleCurrentChange:function(t){var e=t,i=this.page_size,a=this.inputVal;console.log(e,i),this.otherDate?(this.get_patients_by_rules(e,i,this.dateValue,a),console.log("otherdate")):(this.get_patients_by_rules(e,i,"",a),console.log("pagination total"))},turnBlue:function(t){"isActive1"==t.currentTarget.id&&(console.log("isActive1"),this.isActive1=!0,this.isActive2=!1,this.isActive3=!1,this.isActive4=!1,this.otherDate=!1,this.dateValue="",this.refresh())},get_patients:function(t,e,i,a){var n=this,o=y.a.getCookie("hospital_id");_.a.get(x+"/patients/?p="+t+"&page_size="+e+"&hospital_id="+o+"&ordering=-apply_time&diagnose_record=1").then(function(t){console.log(t.data.results),n.tableData=t.data.results,n.totalNum=t.data.count}).catch(function(t){console.log(t)})},get_patients_by_rules:function(t,e,i,a){var n=this,o=y.a.getCookie("hospital_id");_.a.get(x+"/patients/?p="+t+"&page_size="+e+"&ordering=-apply_time&apply_time="+i+"&hospital_id="+o+"&search="+a+"&diagnose_record=1").then(function(t){console.log(t),n.tableData=t.data.results,n.totalNum=t.data.count}).catch(function(t){console.log(t)})},selectDate:function(){this.isActive1=!1,this.isActive4=!0,this.otherDate=!0;var t=new Date(this.dateValue),e=t.getFullYear(),i=t.getMonth()+1,a=t.getDate();i>=1&&i<=9&&(i="0"+i),a>=0&&a<=9&&(a="0"+a);var n=e+"-"+i+"-"+a;this.dateValue=n,this.currentPage=1;var o=this.inputVal;console.log(this.dateValue),console.log(o),this.get_patients_by_rules(1,this.page_size,n,o)},searchBtn:function(){console.log("searchBtn"),this.currentPage=1,this.get_patients_by_rules(1,this.page_size,this.dateValue,this.inputVal)},formatSex:function(t){return"1"===t.patient_gender?"男":"0"===t.patient_gender?"女":"未知"},formatStatus:function(t){return"0"===t.status?"已诊断":(t.status,"已诊断")},formatTime:function(t){var e=t.diagnose.length-1;return t.diagnose[e].apply_time},handleEdit:function(t,e){console.log("qqqqq",t,e);var i=e.historyDisease;console.log(i),i[0]?(console.log("有既往史"),this.editFormVisible=!0,this.editForm=v()({},e),this.editFormJwsForm=i[0],this.editFormLeftDiopterValue=i[0].left_diopter,this.editFormRightDiopterValue=i[0].right_diopter,this.editForm.jwsExist=1,this.editFormjwsVisible=!0,this.radio=3):(console.log("无既往史"),this.editFormVisible=!0,this.editForm=v()({},e),this.editForm.jwsExist=0,this.editFormjwsVisible=!1,this.radio=6)},editjws:function(){var t=this.radio;console.log(t),3===t?(this.editForm.jwsExist=1,this.editFormjwsVisible=!0):6===t&&(this.editFormjwsVisible=!1,this.editFormJwsForm={},this.editFormRightDiopterValue="",this.editFormLeftDiopterValue="",this.editForm.jwsExist=0)},editSubmit:function(){var t=this;this.$refs.editForm.validate(function(e){e&&t.$confirm("确认提交吗？","提示",{}).then(function(){t.editLoading=!0,console.log(123456789);var e=t.editFormJwsForm;console.log(t.editForm);var i={};""!==t.editFormLeftDiopterValue&&(e.left_diopter=t.editFormLeftDiopterValue),""!==t.editFormRightDiopterValue&&(e.right_diopter=t.editFormRightDiopterValue),i.jwsInfo=e,i.basicInfo=t.editForm,console.log("13256",i);var a=v()({},i);console.log("para",a),Object(b.d)(a).then(function(e){t.editLoading=!1,t.$message({message:"提交成功",type:"success"}),t.$refs.editForm.resetFields(),t.editFormVisible=!1,t.refresh()})})})},handleSelectionChange:function(t){this.multipleSelection=t,console.log(t)},batchPdfGen:function(){var t=this;0!==this.multipleSelection.length?this.$confirm("即将批量生成诊断报告, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.sendBatchToServer(),t.nominateZip()}).catch(function(e){console.log(e),t.$message({type:"info",message:"已取消"})}):this.$message({message:"请选择患者",type:"error"})},sendBatchToServer:function(){var t=this,e=this.multipleSelection,i=this.$loading({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});_.a.post(x+"operation/createPdf/",e).then(function(e){if(console.log("res=>",e.data),e.data.length>5){if(i.close(),confirm("生成成功，是否下载压缩包？")){var a=e.data,n=document.getElementById("downloadzip");n.href=a,n.click()}}else i.close(),t.$alert("诊断报告生成失败","提示",{confirmButtonText:"确定"})}).catch(function(e){console.log(e),i.close(),t.$alert("请允许弹窗","提示",{confirmButtonText:"确定"})})},handleView:function(t,e){this.reportFormVisible=!0,this.value=!0,this.reportForm=v()({},e),console.log(t,e);var i=this.getPictureInfo(e.picture);console.log("picList",i),this.picList=i;for(var a=this.picList[0].hospital,n=x+"media/"+a+"/",o=[],r=0;r<this.picList[0].data.length;r++)o.push(n+this.picList[0].data[r]);console.log("132456",o);for(var s=[],l=[],c=0;c<o.length;c++)-1!==o[c].search("left")?s.push(o[c]):l.push(o[c]);this.right_src=l[0],this.left_src=s[0],this.right_srcList=l,this.left_srcList=s},closeReport:function(){var t=this;setTimeout(function(){t.reportFormVisible=!1},500)},getPictureInfo:function(t){for(var e={},i=[],a=0;a<t.length;a++){var n=t[a],o=n.pic_name,r=n.hospital;if(e[n.own_to])for(var s=0;s<i.length;s++){var l=i[s];if(l.own_to===n.own_to){l.data.push(o);break}}else i.push({own_to:n.own_to,hospital:r,data:[o]}),e[n.own_to]=n}return i},changeCarousel:function(t){console.log(t,this.picList);for(var e=this.picList[t].hospital,i=x+"media/"+e+"/",a=[],n=0;n<this.picList[t].data.length;n++)a.push(i+this.picList[t].data[n]);console.log("132456",a);for(var o=[],r=[],s=0;s<a.length;s++)-1!==a[s].search("left")?o.push(a[s]):r.push(a[s]);this.right_src=r[0],this.left_src=o[0],this.right_srcList=r,this.left_srcList=o},nominateZip:function(){var t=document.getElementById("downloadzip"),e=this.getNowFormatDate();t.setAttribute("download",e+".zip")},getNowFormatDate:function(){var t=new Date,e=t.getMonth()+1,i=t.getDate();return e>=1&&e<=9&&(e="0"+e),i>=0&&i<=9&&(i="0"+i),t.getFullYear()+""+e+i+"/"+t.getHours()+"_"+t.getMinutes()+"_"+t.getSeconds()}},data:function(){return{picList:[],tableData:[],multipleSelection:[],dateValue:"",isActive1:!0,isActive2:!1,isActive3:!1,isActive4:!1,currentPage:1,inputVal:"",value:!0,page_size:10,totalNum:30,otherDate:!1,pickerOptions:{disabledDate:function(t){return t.getTime()>Date.now()},shortcuts:[{text:"今天",onClick:function(t){t.$emit("pick",new Date)}},{text:"昨天",onClick:function(t){var e=new Date;e.setTime(e.getTime()-864e5),t.$emit("pick",e)}},{text:"一周前",onClick:function(t){var e=new Date;e.setTime(e.getTime()-6048e5),t.$emit("pick",e)}}]},editFormVisible:!1,reportFormVisible:!1,editLoading:!1,editFormRules:{patient_name:[{required:!0,message:"请输入姓名",trigger:"blur"}],patient_tel:[{required:!0,message:"请输入手机号",trigger:"blur"}]},editForm:{patient_id:0,patient_name:"测试",patient_gender:"0",patient_age:0,patient_tel:18888888888,birth:"",jwsRadio:0,jwsExist:0,jwsVisible:!1,address:""},editFormJwsForm:{other:"",DM_year:"",HTN_year:"",HPL_year:"",pregnant_weeks:""},radio:3,reportForm:{patient_id:0,patient_name:"测试",patient_gender:"0",patient_age:0,patient_tel:18888888888,address:"",diagnose:[]},editFormLeftDiopter:[{value:"0",label:"正视"},{value:"1",label:"低度近视(75~300)"},{value:"2",label:"中度近视(75~300)"},{value:"3",label:"高度近视(75~300)"},{value:"4",label:"远视"}],editFormRightDiopter:[{value:"0",label:"正视"},{value:"1",label:"低度近视(75~300)"},{value:"2",label:"中度近视(75~300)"},{value:"3",label:"高度近视(75~300)"},{value:"4",label:"远视"}],editFormLeftDiopterValue:"",editFormRightDiopterValue:"",left_src:"http://127.0.0.1:8000/media/156654226624064420667.jpg",right_src:"http://127.0.0.1:8000/media/156654226624064420667.jpg",left_srcList:[],right_srcList:[]}}},k={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"undiagnosed",attrs:{id:"diagnosedPage"}},[i("el-row",[i("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[i("el-breadcrumb-item",{attrs:{to:{path:"/"}}},[t._v("PACS")]),t._v(" "),i("el-breadcrumb-item",[t._v("已诊列表")])],1)],1),t._v(" "),i("el-row",{staticClass:"operationNew"},[i("el-col",{class:{active:t.isActive1},attrs:{span:2}},[i("a",{attrs:{id:"isActive1",href:"javascript:;"},on:{click:t.turnBlue}},[t._v("全部")])]),t._v(" "),i("el-col",{staticClass:"timepicker",class:{active:t.isActive4},attrs:{span:3}},[i("a",{attrs:{id:"isActive4",href:"javascript:;"},on:{click:function(t){}}},[i("el-date-picker",{attrs:{align:"right",type:"date",placeholder:"选择日期","picker-options":t.pickerOptions},on:{change:t.selectDate},model:{value:t.dateValue,callback:function(e){t.dateValue=e},expression:"dateValue"}})],1)]),t._v(" "),i("el-col",{attrs:{span:6}},[t._v(" ")]),t._v(" "),i("el-col",{attrs:{span:4}},[i("el-button",{attrs:{type:"primary"},on:{click:t.batchPdfGen}},[t._v("批量生成报告"),i("i",{staticClass:"el-icon-printer el-icon--right"})])],1),t._v(" "),i("div",{staticStyle:{"text-align":"center"}},[i("el-col",{attrs:{span:2}},[i("a",{attrs:{href:"javascript:;"},on:{click:t.refresh}},[i("i",{staticClass:"icon iconfont icon-shuaxin1"}),t._v("刷新")]),t._v(" "),i("a",{staticStyle:{display:"none"},attrs:{id:"downloadzip",href:"",download:"Re.zip"}},[t._v("Download file")])]),t._v(" "),i("el-col",{attrs:{span:5}},[i("el-input",{attrs:{placeholder:"输入患者姓名/手机号/身份证号 可模糊检索"},model:{value:t.inputVal,callback:function(e){t.inputVal=e},expression:"inputVal"}})],1),t._v(" "),i("el-col",{attrs:{span:2}},[i("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.searchBtn}},[t._v("搜索")])],1)],1)],1),t._v(" "),i("el-row",{staticClass:"dataZone"},[[i("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:t.tableData,stripe:""},on:{"selection-change":t.handleSelectionChange}},[i("el-table-column",{attrs:{type:"selection",width:"55"}}),t._v(" "),i("el-table-column",{attrs:{prop:"patient_id",label:"患者编号"}}),t._v(" "),i("el-table-column",{attrs:{prop:"patient_name",label:"姓名"}}),t._v(" "),i("el-table-column",{attrs:{prop:"patient_gender",label:"性别",formatter:t.formatSex}}),t._v(" "),i("el-table-column",{attrs:{prop:"patient_age",label:"年龄"}}),t._v(" "),i("el-table-column",{attrs:{prop:"patient_tel",label:"手机号"}}),t._v(" "),i("el-table-column",{attrs:{prop:"apply_time",label:"录入时间",formatter:t.formatTime}}),t._v(" "),i("el-table-column",{attrs:{prop:"status",label:"状态",formatter:t.formatStatus}}),t._v(" "),i("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-view",circle:""},on:{click:function(i){return t.handleView(e.$index,e.row)}}}),t._v(" "),i("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-edit",circle:""},on:{click:function(i){return t.handleEdit(e.$index,e.row)}}})]}}])})],1)]],2),t._v(" "),i("el-row",{staticClass:"pagination"},[i("el-pagination",{attrs:{"current-page":t.currentPage,"page-sizes":[5,10],"page-size":t.page_size,layout:"total, sizes, prev, pager, next, jumper",total:t.totalNum},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange,"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e}}})],1),t._v(" "),i("el-dialog",{attrs:{title:"编辑",visible:t.editFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(e){t.editFormVisible=e}},model:{value:t.editFormVisible,callback:function(e){t.editFormVisible=e},expression:"editFormVisible"}},[i("el-form",{ref:"editForm",attrs:{model:t.editForm,"label-width":"80px",rules:t.editFormRules}},[i("el-form-item",{staticStyle:{width:"25%"},attrs:{label:"姓名",prop:"patient_name"}},[i("el-input",{attrs:{"auto-complete":"off"},model:{value:t.editForm.patient_name,callback:function(e){t.$set(t.editForm,"patient_name",e)},expression:"editForm.patient_name"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"手机号",prop:"patient_tel"}},[i("el-input",{staticStyle:{width:"25%"},attrs:{type:"text",placeholder:"手机号",oninput:"value=value.replace(/[^\\d]/g,'')",maxlength:"11","show-word-limit":""},model:{value:t.editForm.patient_tel,callback:function(e){t.$set(t.editForm,"patient_tel",e)},expression:"editForm.patient_tel"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"性别"}},[i("el-radio-group",{model:{value:t.editForm.patient_gender,callback:function(e){t.$set(t.editForm,"patient_gender",e)},expression:"editForm.patient_gender"}},[i("el-radio",{staticClass:"radio",attrs:{label:"1"}},[t._v("男")]),t._v(" "),i("el-radio",{staticClass:"radio",attrs:{label:"0"}},[t._v("女")])],1)],1),t._v(" "),i("el-form-item",{attrs:{label:"年龄"}},[i("el-input-number",{staticStyle:{width:"25%"},attrs:{oninput:"value=value.replace(/[^\\d]/g,'')",min:0,max:200},model:{value:t.editForm.patient_age,callback:function(e){t.$set(t.editForm,"patient_age",e)},expression:"editForm.patient_age"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"既往史"}},[[i("el-radio-group",{attrs:{onchange:t.editjws()},model:{value:t.radio,callback:function(e){t.radio=e},expression:"radio"}},[i("el-radio",{attrs:{label:3}},[t._v("有")]),t._v(" "),i("el-radio",{attrs:{label:6}},[t._v("无")])],1)],t._v(" "),i("br"),t._v(" "),t.editFormjwsVisible?i("el-form-item",[i("span",[t._v("糖尿病:")]),i("el-input-number",{attrs:{"controls-position":"right",size:"mini",min:0,max:100},model:{value:t.editFormJwsForm.DM_year,callback:function(e){t.$set(t.editFormJwsForm,"DM_year",e)},expression:"editFormJwsForm.DM_year"}}),t._v("年\n                            \n            "),i("span",[t._v("高血压:")]),i("el-input-number",{attrs:{"controls-position":"right",size:"mini",min:0,max:100},model:{value:t.editFormJwsForm.HTN_year,callback:function(e){t.$set(t.editFormJwsForm,"HTN_year",e)},expression:"editFormJwsForm.HTN_year"}}),t._v("年\n            "),i("br"),t._v(" "),i("span",[t._v("高血脂:")]),i("el-input-number",{attrs:{"controls-position":"right",size:"mini",min:0,max:100},model:{value:t.editFormJwsForm.HPL_year,callback:function(e){t.$set(t.editFormJwsForm,"HPL_year",e)},expression:"editFormJwsForm.HPL_year"}}),t._v("年\n                            \n            "),i("span",[t._v("   妊娠:")]),i("el-input-number",{attrs:{"controls-position":"right",size:"mini",min:0,max:100},model:{value:t.editFormJwsForm.pregnant_weeks,callback:function(e){t.$set(t.editFormJwsForm,"pregnant_weeks",e)},expression:"editFormJwsForm.pregnant_weeks"}}),t._v("周\n            "),i("br"),t._v(" "),i("span",[t._v("其他:   ")]),i("el-input",{staticStyle:{width:"410px"},attrs:{size:"mini",placeholder:"请输入内容",clearable:""},model:{value:t.editFormJwsForm.other,callback:function(e){t.$set(t.editFormJwsForm,"other",e)},expression:"editFormJwsForm.other"}}),t._v(" "),i("br"),t._v(" "),i("span",[t._v("屈光度:")]),t._v("\n            左眼:"),[i("el-select",{staticStyle:{width:"150px"},attrs:{size:"mini",clearable:"",placeholder:"请选择"},model:{value:t.editFormLeftDiopterValue,callback:function(e){t.editFormLeftDiopterValue=e},expression:"editFormLeftDiopterValue"}},t._l(t.editFormLeftDiopter,function(t){return i("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],t._v("\n                     右眼:"),[i("el-select",{staticStyle:{width:"150px"},attrs:{size:"mini",clearable:"",placeholder:"请选择"},model:{value:t.editFormRightDiopterValue,callback:function(e){t.editFormRightDiopterValue=e},expression:"editFormRightDiopterValue"}},t._l(t.editFormLeftDiopter,function(t){return i("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)]],2):t._e()],2),t._v(" "),i("br"),t._v(" "),i("el-form-item",{attrs:{label:"地址"}},[i("el-input",{attrs:{type:"textarea"},model:{value:t.editForm.address,callback:function(e){t.$set(t.editForm,"address",e)},expression:"editForm.address"}})],1)],1),t._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{nativeOn:{click:function(e){t.editFormVisible=!1}}},[t._v("取消")]),t._v(" "),i("el-button",{attrs:{type:"primary",loading:t.editLoading},nativeOn:{click:function(e){return t.editSubmit(e)}}},[t._v("提交")])],1)],1),t._v(" "),t.reportFormVisible?i("el-carousel",{staticStyle:{width:"800px",position:"fixed","z-index":"99",left:"30%",top:"1%",bottom:"1%"},attrs:{interval:4e3,height:"900px"},on:{change:t.changeCarousel}},t._l(this.reportForm.diagnose,function(e,a){return i("el-carousel-item",{key:e.id},[i("el-row",{staticStyle:{"text-align":"center","font-weight":"bold","font-size":"x-large","margin-top":"10px"}},[i("el-col",{attrs:{span:5}},[t._v(" ")]),t._v(" "),i("el-col",{attrs:{span:14,id:"report"}},[t._v("诊断报告"),i("span",{staticStyle:{"font-weight":"unset","font-size":"small"}},[t._v("(序号:"+t._s(a+1)+"/"+t._s(t.reportForm.diagnose.length)+")")])]),t._v(" "),i("el-col",{attrs:{span:5}},[i("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},on:{change:t.closeReport},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}}),t._v(" "),i("span",{staticStyle:{"font-weight":"unset","font-size":"small"}},[t._v("关闭")])],1)],1),t._v(" "),i("el-row",{staticStyle:{"margin-top":"20px"}},[i("el-col",{attrs:{span:1}},[t._v(" ")]),t._v(" "),i("el-col",{attrs:{span:6}},[t._v("姓名:"+t._s(t.reportForm.patient_name))]),t._v(" "),i("el-col",{attrs:{span:6}},[t._v("性别:"+t._s(t.reportForm.patient_gender))]),t._v(" "),i("el-col",{attrs:{span:6}},[t._v("年龄:"+t._s(t.reportForm.patient_age))]),t._v(" "),i("el-col",{attrs:{span:5}},[t._v("日期:"+t._s(t.reportForm.diagnose[a].diagnose_time))])],1),t._v(" "),i("el-row",{staticStyle:{"margin-top":"20px"}},[i("el-col",{staticStyle:{"text-align":"center"},attrs:{span:12}},[t._v("OD")]),t._v(" "),i("el-col",{staticStyle:{"text-align":"center"},attrs:{span:12}},[t._v("OS")])],1),t._v(" "),i("el-row",{staticStyle:{"margin-top":"30px"}},[i("el-col",{staticStyle:{"text-align":"center"},attrs:{span:12}},[i("div",{staticClass:"demo-image__preview"},[i("el-image",{staticStyle:{height:"250px"},attrs:{src:t.right_src,"preview-src-list":t.right_srcList}})],1)]),t._v(" "),i("el-col",{staticStyle:{"text-align":"center"},attrs:{span:12}},[i("div",{staticClass:"demo-image__preview"},[i("el-image",{staticStyle:{height:"250px"},attrs:{src:t.left_src,"preview-src-list":t.left_srcList}})],1)])],1),t._v(" "),i("el-row",{staticStyle:{"margin-top":"20px","font-weight":"bold","font-size":"large"}},[i("el-col",{attrs:{span:1}},[t._v(" ")]),t._v(" "),i("el-col",{attrs:{span:4}},[t._v("影像发现")]),t._v(" "),i("el-col",{attrs:{span:19}})],1),t._v(" "),i("el-row",{staticStyle:{"margin-top":"10px"}},[i("el-col",{attrs:{span:1}},[t._v(" ")]),t._v(" "),i("el-col",{attrs:{span:4}},[t._v("类别")]),t._v(" "),i("el-col",{attrs:{span:19}})],1),t._v(" "),i("el-row",{staticStyle:{"margin-top":"10px"}},[i("el-col",{attrs:{span:1}},[t._v(" ")]),t._v(" "),i("el-col",{attrs:{span:4}},[t._v("渗出")]),t._v(" "),i("el-col",{attrs:{span:19}})],1),t._v(" "),i("el-row",{staticStyle:{"margin-top":"10px"}},[i("el-col",{attrs:{span:1}},[t._v(" ")]),t._v(" "),i("el-col",{attrs:{span:4}},[t._v("出血")]),t._v(" "),i("el-col",{attrs:{span:19}})],1),t._v(" "),i("el-row",{staticStyle:{"margin-top":"20px","font-weight":"bold","font-size":"large"}},[i("el-col",{attrs:{span:1}},[t._v(" ")]),t._v(" "),i("el-col",{attrs:{span:4}},[t._v("诊断")]),t._v(" "),i("el-col",{attrs:{span:19}})],1),t._v(" "),i("el-row",{staticStyle:{"margin-top":"10px"}},[i("el-col",{attrs:{span:1}},[t._v(" ")]),t._v(" "),i("el-col",{attrs:{span:4}},[t._v("左眼")]),t._v(" "),i("el-col",{attrs:{span:19}})],1),t._v(" "),i("el-row",{staticStyle:{"margin-top":"10px"}},[i("el-col",{attrs:{span:1}},[t._v(" ")]),t._v(" "),i("el-col",{attrs:{span:4}},[t._v("右眼")]),t._v(" "),i("el-col",{attrs:{span:19}})],1),t._v(" "),i("el-row",{staticStyle:{"margin-top":"20px","font-weight":"bold","font-size":"large"}},[i("el-col",{attrs:{span:1}},[t._v(" ")]),t._v(" "),i("el-col",{attrs:{span:23}},[t._v("建议:")])],1),t._v(" "),i("el-row",{staticStyle:{"margin-top":"10px","font-size":"large"}},[i("el-col",{attrs:{span:1}},[t._v(" ")]),t._v(" "),i("el-col",{attrs:{span:23}},[t._v(t._s(t.reportForm.diagnose[a].diagnose_advice))])],1)],1)}),1):t._e()],1)},staticRenderFns:[]};var S=i("VU/8")(F,k,!1,function(t){i("bvOk")},"data-v-c4efab24",null).exports,V=w.a.url,C={name:"undiagnosed",created:function(){this.get_patients(1,10)},methods:{refresh:function(){this.currentPage=1;var t=this.page_size,e=this.inputVal;this.otherDate?(this.get_patients_by_rules(1,t,this.dateValue,e),console.log("otherdate")):(this.get_patients_by_rules(1,t,"",e),console.log("total"))},handleSizeChange:function(t){var e=t;this.page_size=e,this.currentPage=1;var i=this.currentPage,a=this.inputVal;console.log(i,e),this.otherDate?(this.get_patients_by_rules(i,e,this.dateValue,a),console.log("otherdate")):(this.get_patients_by_rules(i,e,"",a),console.log("page_size total"))},handleCurrentChange:function(t){var e=t,i=this.page_size,a=this.inputVal;console.log(e,i),this.otherDate?(this.get_patients_by_rules(e,i,this.dateValue,a),console.log("otherdate")):(this.get_patients_by_rules(e,i,"",a),console.log("pagination total"))},turnBlue:function(t){"isActive1"==t.currentTarget.id&&(console.log("isActive1"),this.isActive1=!0,this.isActive2=!1,this.isActive3=!1,this.isActive4=!1,this.otherDate=!1,this.dateValue="",this.refresh())},tabledataProcess:function(t){for(var e=[],i=[],a=0;a<t.length;a++)if(-1===e.indexOf(t[a].patient_id)){var n=t[a].diagnose.length;null!==t[a].diagnose[n-1].review_time&&(e.push(t[a].patient_id),i.push(t[a]))}return console.log(i),i},get_patients:function(t,e,i,a){var n=this,o=y.a.getCookie("hospital_id");_.a.get(V+"/patients/?p="+t+"&page_size="+e+"&hospital_id="+o+"&ordering=-apply_time&review_time=-").then(function(t){var e=n.tabledataProcess(t.data.results);n.tableData=e,n.totalNum=e.length}).catch(function(t){console.log(t)})},get_patients_by_rules:function(t,e,i,a){var n=this,o=y.a.getCookie("hospital_id");_.a.get(V+"/patients/?p="+t+"&page_size="+e+"&ordering=-apply_time&apply_time="+i+"&search="+a+"&hospital_id="+o+"&review_time=-").then(function(t){var e=n.tabledataProcess(t.data.results);n.tableData=e,n.totalNum=e.length}).catch(function(t){console.log(t)})},selectDate:function(){this.isActive1=!1,this.isActive4=!0,this.otherDate=!0;var t=new Date(this.dateValue),e=t.getFullYear(),i=t.getMonth()+1,a=t.getDate();i>=1&&i<=9&&(i="0"+i),a>=0&&a<=9&&(a="0"+a);var n=e+"-"+i+"-"+a;this.dateValue=n,this.currentPage=1;var o=this.inputVal;console.log(this.dateValue),console.log(o),this.get_patients_by_rules(1,this.page_size,n,o)},searchBtn:function(){console.log("searchBtn"),this.currentPage=1,this.get_patients_by_rules(1,this.page_size,this.dateValue,this.inputVal)},formatSex:function(t){return"1"===t.patient_gender?"男":"0"===t.patient_gender?"女":"未知"},formatStatus:function(t){var e=t.diagnose.length-1;return"unInform"===t.diagnose[e].inform_type?"未通知":"message"===t.diagnose[e].inform_type?"已短息通知":"已电话通知"},formatTime:function(t){var e=t.diagnose.length-1;return t.diagnose[e].apply_time},handleEdit:function(t,e){console.log(t,e);var i=e.diagnose.length;e.review_time=e.diagnose[i-1].review_time,e.review_hospital=e.diagnose[i-1].review_hospital,this.editFormVisible=!0,this.editForm=v()({},e)},editSubmit:function(){var t=this;this.$refs.editForm.validate(function(e){e&&t.$confirm("确认提交吗？","提示",{}).then(function(){t.editLoading=!0;var e=v()({},t.editForm);console.log(e),Object(b.e)(e).then(function(e){t.editLoading=!1,t.$message({message:"提交成功",type:"success"}),t.$refs.editForm.resetFields(),t.editFormVisible=!1,t.refresh()})})})},handleSelectionChange:function(t){this.multipleSelection=t,console.log(t)},showSms:function(t,e){this.dialogVisible=!0,console.log(t,e);var i=e.diagnose.length;e.review_time=e.diagnose[i-1].review_time,e.review_hospital=e.diagnose[i-1].review_hospital,this.editForm=v()({},e)},sendSms:function(){var t=this;this.dialogVisible=!1;var e=v()({},this.editForm);Object(b.h)(e).then(function(e){"1"==e?t.$message({message:"短信发送成功",type:"success"}):t.$message({message:"短信发送失败",type:"error"}),t.editLoading=!1,t.refresh()})},batchSendSms:function(){var t=this;0!=this.multipleSelection.length?this.$confirm("即将批量发送短信, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.dialogVisible=!1;var e=t.multipleSelection;Object(b.h)(e).then(function(e){console.log("res>",e),"1"==e?t.$message({message:"短信发送成功",type:"success"}):t.$message({message:"短信发送失败",type:"error"}),t.editLoading=!1,t.refresh()})}).catch(function(){t.$message({type:"info",message:"已取消"})}):this.$message({message:"请选择患者",type:"error"})}},data:function(){return{tableData:[],multipleSelection:[],dateValue:"",isActive1:!0,isActive2:!1,isActive3:!1,isActive4:!1,currentPage:1,inputVal:"",page_size:10,totalNum:30,otherDate:!1,dialogVisible:!1,pickerOptions:{disabledDate:function(t){return t.getTime()>Date.now()},shortcuts:[{text:"今天",onClick:function(t){t.$emit("pick",new Date)}},{text:"昨天",onClick:function(t){var e=new Date;e.setTime(e.getTime()-864e5),t.$emit("pick",e)}},{text:"一周前",onClick:function(t){var e=new Date;e.setTime(e.getTime()-6048e5),t.$emit("pick",e)}}]},reviewTimeOption:{disabledDate:function(t){return t.getTime()<Date.now()}},editFormVisible:!1,editLoading:!1,editFormRules:{patient_name:[{required:!0,message:"请输入姓名",trigger:"blur"}],patient_tel:[{required:!0,message:"请输入手机号",trigger:"blur"}],review_time:[{required:!0,message:"请输复诊时间",trigger:"blur"}],review_hospital:[{required:!0,message:"请输复诊医院",trigger:"blur"}]},editForm:{patient_id:0,patient_name:"测试",patient_gender:"0",patient_age:0,patient_tel:18888888888,birth:"",address:"",review_time:"",review_hospital:"兴园社区"}}}},D={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"undiagnosed"},[i("el-row",[i("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[i("el-breadcrumb-item",{attrs:{to:{path:"/"}}},[t._v("PACS")]),t._v(" "),i("el-breadcrumb-item",[t._v("转化列表")])],1)],1),t._v(" "),i("el-row",{staticClass:"operationNew"},[i("el-col",{class:{active:t.isActive1},attrs:{span:2}},[i("a",{attrs:{id:"isActive1",href:"javascript:;"},on:{click:t.turnBlue}},[t._v("全部")])]),t._v(" "),i("el-col",{staticClass:"timepicker",class:{active:t.isActive4},attrs:{span:3}},[i("a",{attrs:{id:"isActive4",href:"javascript:;"},on:{click:function(t){}}},[i("el-date-picker",{attrs:{align:"right",type:"date",placeholder:"选择日期","picker-options":t.pickerOptions},on:{change:t.selectDate},model:{value:t.dateValue,callback:function(e){t.dateValue=e},expression:"dateValue"}})],1)]),t._v(" "),i("el-col",{attrs:{span:6}},[t._v(" ")]),t._v(" "),i("el-col",{attrs:{span:4}},[i("el-button",{attrs:{type:"primary"},on:{click:t.batchSendSms}},[t._v("批量发送短信"),i("i",{staticClass:"el-icon-s-comment el-icon--right"})])],1),t._v(" "),i("div",{staticStyle:{"text-align":"center"}},[i("el-col",{attrs:{span:2}},[i("a",{attrs:{href:"javascript:;"},on:{click:t.refresh}},[i("i",{staticClass:"icon iconfont icon-shuaxin1"}),t._v("刷新")])]),t._v(" "),i("el-col",{attrs:{span:5}},[i("el-input",{attrs:{placeholder:"输入患者姓名/手机号/身份证号 可模糊检索"},model:{value:t.inputVal,callback:function(e){t.inputVal=e},expression:"inputVal"}})],1),t._v(" "),i("el-col",{attrs:{span:2}},[i("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.searchBtn}},[t._v("搜索")])],1)],1)],1),t._v(" "),i("el-row",{staticClass:"dataZone"},[[i("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:t.tableData,stripe:""},on:{"selection-change":t.handleSelectionChange}},[i("el-table-column",{attrs:{type:"selection",width:"55"}}),t._v(" "),i("el-table-column",{attrs:{prop:"patient_id",label:"患者编号"}}),t._v(" "),i("el-table-column",{attrs:{prop:"patient_name",label:"姓名"}}),t._v(" "),i("el-table-column",{attrs:{prop:"patient_gender",label:"性别",formatter:t.formatSex}}),t._v(" "),i("el-table-column",{attrs:{prop:"patient_age",label:"年龄"}}),t._v(" "),i("el-table-column",{attrs:{prop:"patient_tel",label:"手机号"}}),t._v(" "),i("el-table-column",{attrs:{prop:"apply_time",label:"录入时间",formatter:t.formatTime}}),t._v(" "),i("el-table-column",{attrs:{prop:"diagnose[diagnose.length - 1].inform_type",label:"状态",formatter:t.formatStatus}}),t._v(" "),i("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-chat-dot-round",circle:""},on:{click:function(i){return t.showSms(e.$index,e.row)}}}),t._v(" "),i("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-edit",circle:""},on:{click:function(i){return t.handleEdit(e.$index,e.row)}}})]}}])})],1)]],2),t._v(" "),i("el-row",{staticClass:"pagination"},[i("el-pagination",{attrs:{"current-page":t.currentPage,"page-sizes":[5,10],"page-size":t.page_size,layout:"total, sizes, prev, pager, next, jumper",total:t.totalNum},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange,"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e}}})],1),t._v(" "),i("el-dialog",{attrs:{title:"编辑复查医院和时间",visible:t.editFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(e){t.editFormVisible=e}},model:{value:t.editFormVisible,callback:function(e){t.editFormVisible=e},expression:"editFormVisible"}},[i("el-form",{ref:"editForm",attrs:{model:t.editForm,"label-width":"80px",rules:t.editFormRules}},[i("el-form-item",{staticStyle:{width:"25%"},attrs:{label:"姓名",prop:"patient_name"}},[i("el-input",{attrs:{"auto-complete":"off",readonly:""},model:{value:t.editForm.patient_name,callback:function(e){t.$set(t.editForm,"patient_name",e)},expression:"editForm.patient_name"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"手机号",prop:"patient_tel"}},[i("el-input",{staticStyle:{width:"25%"},attrs:{type:"text",placeholder:"手机号",oninput:"value=value.replace(/[^\\d]/g,'')",maxlength:"11","show-word-limit":""},model:{value:t.editForm.patient_tel,callback:function(e){t.$set(t.editForm,"patient_tel",e)},expression:"editForm.patient_tel"}})],1),t._v(" "),i("el-form-item",{staticStyle:{width:"25%"},attrs:{label:"复查时间",prop:"review_time"}},[i("el-date-picker",{attrs:{align:"right",type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd","picker-options":t.reviewTimeOption},model:{value:t.editForm.review_time,callback:function(e){t.$set(t.editForm,"review_time",e)},expression:"editForm.review_time"}})],1),t._v(" "),i("el-form-item",{staticStyle:{width:"25%"},attrs:{label:"复查医院",prop:"review_hospital"}},[i("el-input",{attrs:{type:"text"},model:{value:t.editForm.review_hospital,callback:function(e){t.$set(t.editForm,"review_hospital",e)},expression:"editForm.review_hospital"}})],1)],1),t._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{nativeOn:{click:function(e){t.editFormVisible=!1}}},[t._v("取消")]),t._v(" "),i("el-button",{attrs:{type:"primary",loading:t.editLoading},nativeOn:{click:function(e){return t.editSubmit(e)}}},[t._v("提交")])],1)],1),t._v(" "),i("el-dialog",{attrs:{title:"提示",visible:t.dialogVisible,width:"30%"},on:{"update:visible":function(e){t.dialogVisible=e}}},[i("span",[t._v("您将要发送如下短信:"),i("br"),t._v("尊敬的"+t._s(t.editForm.patient_name)+"\n        "),"0"===t.editForm.patient_gender?i("span",[t._v("女士")]):i("span",[t._v("先生")]),t._v(",\n        请于"+t._s(t.editForm.review_time)+"前,前往"+t._s(t.editForm.review_hospital)+"进行眼底情况检查")]),t._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:t.sendSms}},[t._v("确 定")])],1)])],1)},staticRenderFns:[]};var T=i("VU/8")(C,D,!1,function(t){i("3itp")},"data-v-76a7cda4",null).exports,j=i("ARhN"),L=i.n(j),$={data:function(){return{chartColumn:null,chartBar:null,chartLine:null,chartPie:null}},methods:{drawColumnChart:function(){this.chartColumn=L.a.init(document.getElementById("chartColumn")),this.chartColumn.setOption({title:{text:"Column Chart"},tooltip:{},xAxis:{data:["渗出","豹纹眼底","青光眼","白内障","糖网","黄斑病变"]},yAxis:{},series:[{name:"销量",type:"bar",data:[5,20,36,10,10,20]}]})},drawBarChart:function(){this.chartBar=L.a.init(document.getElementById("chartBar")),this.chartBar.setOption({title:{text:"Bar Chart",subtext:"数据来自奥比斯科技"},tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{data:["2018年","2019年"]},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"value",boundaryGap:[0,.01]},yAxis:{type:"category",data:["天乐","兴园","荷叶地","普瑞","爱尔","病患转化数(万)"]},series:[{name:"2018年",type:"bar",data:[18203,23489,29034,104970,131744,630230]},{name:"2019年",type:"bar",data:[19325,23438,31e3,121594,134141,681807]}]})},drawLineChart:function(){this.chartLine=L.a.init(document.getElementById("chartLine")),this.chartLine.setOption({title:{text:"Line Chart"},tooltip:{trigger:"axis"},legend:{data:["短信营销","电话营销","邮件营销"]},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:["周一","周二","周三","周四","周五","周六","周日"]},yAxis:{type:"value"},series:[{name:"短信营销",type:"line",stack:"总量",data:[120,132,101,134,90,230,210]},{name:"电话营销",type:"line",stack:"总量",data:[220,182,191,234,290,330,310]},{name:"邮件营销",type:"line",stack:"总量",data:[820,932,901,934,1290,1330,1320]}]})},drawPieChart:function(){this.chartPie=L.a.init(document.getElementById("chartPie")),this.chartPie.setOption({title:{text:"Pie Chart",subtext:"纯属虚构",x:"center"},tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},legend:{orient:"vertical",left:"left",data:["直接访问","邮件营销","联盟广告","视频广告","搜索引擎"]},series:[{name:"访问来源",type:"pie",radius:"55%",center:["50%","60%"],data:[{value:335,name:"直接访问"},{value:310,name:"邮件营销"},{value:234,name:"联盟广告"},{value:135,name:"视频广告"},{value:1548,name:"搜索引擎"}],itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]})},drawCharts:function(){this.drawColumnChart(),this.drawBarChart(),this.drawLineChart(),this.drawPieChart()}},mounted:function(){this.drawCharts()},updated:function(){this.drawCharts()}},A={render:function(){var t=this.$createElement,e=this._self._c||t;return e("section",{staticClass:"chart-container"},[e("el-row",[e("el-col",{attrs:{span:12}},[e("div",{staticStyle:{width:"100%",height:"400px"},attrs:{id:"chartColumn"}})]),this._v(" "),e("el-col",{attrs:{span:12}},[e("div",{staticStyle:{width:"100%",height:"400px"},attrs:{id:"chartBar"}})]),this._v(" "),e("el-col",{attrs:{span:12}},[e("div",{staticStyle:{width:"100%",height:"400px"},attrs:{id:"chartLine"}})]),this._v(" "),e("el-col",{attrs:{span:12}},[e("div",{staticStyle:{width:"100%",height:"400px"},attrs:{id:"chartPie"}})])],1)],1)},staticRenderFns:[]};var z=i("VU/8")($,A,!1,function(t){i("yKzQ")},"data-v-ced4cca0",null).exports,R=i("fZjL"),P=i.n(R),E=w.a.url,O={data:function(){return{patient_info:{},restaurants:[],state:"",timeout:null,suggestions:["定时随访","上级医院就诊","正常,无需随访"],diseases:["高血压视网膜病变","糖尿病视网膜病变","豹纹状眼底","渗出","青光眼","年龄相关性视网膜病变"],fits:["fill"],right_src:"https://www.orbisbiotech.cn/media/xingyuan/2019080410421718855145058_Right_1_origin.png",left_src:"https://www.orbisbiotech.cn/media/xingyuan/2019080410421718855145058_Left_2_origin.png",right_srcList:[],left_srcList:[],dynamicTagsR:[],dynamicTagsL:[],dynamicTagsA:[],diaStrR:"",diaStrL:"",diaStrA:"",finishSeen:!1,beforeSeen:!0,inputVisibleR:!1,inputVisibleL:!1,inputVisibleA:!1,leftEye:!1,rightEye:!1,advice:!1,inputValueR:"",inputValueL:"",inputValueA:"",seen:!0,seen2:!1,eyeSeen:!1,diaSeen:!0,activeColor1:"azure",activeColor2:"azure",dialogVisible:!1,fullscreenLoading:!1,centerDialogVisible:!1,pickerOptions:{disabledDate:function(t){return t.getTime()<Date.now()},shortcuts:[{text:"今天",onClick:function(t){t.$emit("pick",new Date)}},{text:"明天",onClick:function(t){var e=new Date;e.setTime(e.getTime()+864e5),t.$emit("pick",e)}},{text:"一周后",onClick:function(t){var e=new Date;e.setTime(e.getTime()+6048e5),t.$emit("pick",e)}}]},value1:"",value2:""}},methods:{handleCloseR:function(t){this.dynamicTagsR.splice(this.dynamicTagsR.indexOf(t),1)},showInputR:function(){var t=this;this.activeColor2="lightgray",this.inputVisibleR=!0,this.rightEye=!0,this.leftEye=!1,this.$nextTick(function(e){t.$refs.saveTagInputR.$refs.input.focus()})},handleInputConfirmR:function(){this.activeColor2="azure";var t=this.inputValueR;t&&this.dynamicTagsR.push(t),this.inputVisibleR=!1,this.inputValueR=""},handleCloseL:function(t){this.dynamicTagsL.splice(this.dynamicTagsL.indexOf(t),1)},showInputL:function(){var t=this;this.activeColor2="lightgray",this.inputVisibleL=!0,this.rightEye=!1,this.leftEye=!0,this.$nextTick(function(e){t.$refs.saveTagInputL.$refs.input.focus()})},handleInputConfirmL:function(){this.activeColor2="azure";var t=this.inputValueL;t&&this.dynamicTagsL.push(t),this.inputVisibleL=!1,this.inputValueL=""},handleCloseA:function(t){this.dynamicTagsA.splice(this.dynamicTagsA.indexOf(t),1),this.seen=!0,this.seen2=!1,this.value2=""},showInputA:function(){var t=this;this.leftEye=!1,this.rightEye=!1,this.activeColor1="lightgray",this.inputVisibleA=!0,this.advice=!0,this.$nextTick(function(e){t.$refs.saveTagInputA.$refs.input.focus()})},handleInputConfirmA:function(){this.activeColor1="azure";var t=this.inputValueA,e=this.dynamicTagsA;t&&this.dynamicTagsA.push(t),0!==e.length&&(this.seen=!1),this.inputVisibleA=!1,this.inputValueA=""},addDiagnose:function(t){if(this.leftEye){this.dynamicTagsL.push(t);var e=this.duplicateRemove(this.dynamicTagsL);this.dynamicTagsL=e,this.handleInputConfirmL()}else if(this.rightEye){this.dynamicTagsR.push(t);var i=this.duplicateRemove(this.dynamicTagsR);this.dynamicTagsR=i,this.handleInputConfirmR()}},addAdvice:function(t){var e=this.dynamicTagsA;if(this.advice){if(0!==e.length)return;this.dynamicTagsA.push(t),this.handleInputConfirmA(),"上级医院就诊"===t&&(this.dialogVisible=!0,this.seen2=!0)}},formatSex:function(t){return"1"===t.patient_gender?"男":"0"===t.patient_gender?"女":"未知"},finishDiagnose:function(){var t=this.dynamicTagsR.toString(),e=this.dynamicTagsL.toString();this.diaStrR=t,this.diaStrL=e,this.submitDiagnose(),this.eyeSeen=!0,this.diaSeen=!1,this.finishSeen=!0,this.beforeSeen=!1},openFullScreen:function(){var t=this;if(0!==this.dynamicTagsA.length){var e=this.$loading({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});setTimeout(function(){e.close(),t.finishDiagnose()},500)}else this.open()},backToUndiagnosed:function(){var t=this;if(0!==this.dynamicTagsA.length){var e={};e.page_size=this.patient_info.page_size,e.currentPage=this.patient_info.currentPage;var i=this.$loading({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});setTimeout(function(){i.close(),t.finishDiagnose(),t.$store.commit("backToUndiagnosed")},1e3)}else this.open()},onlyBack:function(){var t=this,e={};e.page_size=this.patient_info.page_size,e.currentPage=this.patient_info.currentPage;var i=this.$loading({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});setTimeout(function(){i.close(),t.$store.commit("backToUndiagnosed",e)},1e3)},getConclusion:function(){var t=this;_.a.get(E+"/conclusion/?&ordering=-times").then(function(e){console.log(e.data);for(var i=e.data,a=[],n=0;n<i.length;n++)a.push(i[n].conclusion);t.diseases=a.slice(0,9)}).catch(function(t){console.log(t)})},getDiagnoseResult:function(){var t={},e={},i={};return t.patient_id=this.patient_info.patient_id,t.diagnose_record=this.patient_info.diagnose_record,t.apply_time=this.patient_info.apply_time,t.patient_name=this.patient_info.patient_name,t.patient_gender=this.patient_info.patient_gender,t.patient_age=this.patient_info.patient_age,t.left_diagnose=this.diaStrL,t.right_diagnose=this.diaStrR,t.diagnose_advice=this.dynamicTagsA[0],e.username=y.a.getCookie("name"),e.right_origin_src=this.right_src.split("media")[this.right_src.split("media").length-1],e.left_origin_src=this.left_src.split("media")[this.left_src.split("media").length-1],e.right_AI_src=this.right_src.split("media")[this.right_src.split("media").length-1],e.left_AI_src=this.left_src.split("media")[this.left_src.split("media").length-1],e.oozed_amount="0",e.bleeding_amount="0",e.oozed_area="0",e.bleeding_area="0",e.max_oozed_area="0",e.max_bleeding_area="0",e.other_advice="",i.basic_data=t,i.other_data=e,this.value2&&(t.review_time=this.value2),i},submitDiagnose:function(){var t=this,e=this.getDiagnoseResult();console.log("start submit diagnose result",e),_.a.post(E+"operation/submit/",e).then(function(e){console.log("res=>",e),0===e.data&&t.$alert("阅片失败","提示",{confirmButtonText:"确定"})}).catch(function(e){console.log(e),t.$alert("阅片错误","提示",{confirmButtonText:"确定"})})},duplicateRemove:function(t){for(var e=[],i=0;i<t.length;i++)-1===e.indexOf(t[i])&&e.push(t[i]);return console.log(e),e},createReport:function(){var t=this,e=this.getDiagnoseResult();_.a.post(E+"operation/createPdf/",e).then(function(e){if(console.log("res=>",e.data),1===e.data){var i=Math.random().toString(36).substr(2),a=window.open("",i,"");a.document.title="pdf";a.location="/media/hello.pdf"}else t.$alert("诊断报告生成失败","提示",{confirmButtonText:"确定"})}).catch(function(e){console.log(e),t.$alert("请允许弹窗","提示",{confirmButtonText:"确定"})})},finishAndCreatePdf:function(){var t=this;if(0!==this.dynamicTagsA.length)try{console.log("start submit");var e=this.$loading({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});setTimeout(function(){e.close(),t.finishDiagnose()},500),this.createReport()}catch(t){console.log(t)}else this.open()},cancelSelectDate:function(){this.dialogVisible=!1,this.seen2=!1,this.value2=""},confirmSelectDate:function(){this.dialogVisible=!1,this.value2||(this.seen2=!1,this.value2="")},open:function(){this.$alert("请添加建议","提示",{confirmButtonText:"确定"})},loadAll:function(){var t=this;_.a.get(E+"/conclusion/?&ordering=-times").then(function(e){for(var i=e.data,a=[],n=function(t){delete i[t].id,delete i[t].times;var e={conclusion:"value"},n=P()(i[t]).reduce(function(a,n){return a[e[n]||n]=i[t][n],a},{});a.push(n)},o=0;o<i.length;o++)n(o);t.restaurants=a}).catch(function(e){console.log(e),t.restaurants=[]})},querySearchAsync:function(t,e){var i=this.restaurants,a=t?i.filter(this.createStateFilter(t)):i;clearTimeout(this.timeout),this.timeout=setTimeout(function(){e(a)},300*Math.random())},createStateFilter:function(t){return function(e){return 0===e.value.toLowerCase().indexOf(t.toLowerCase())}},handleSelect:function(t){console.log(t.value),this.addDiagnose(t.value)}},mounted:function(){this.loadAll(),document.getElementById("aside_id").style.height=window.innerHeight-46+"px",this.patient_info=this.$store.state.patient_info;try{var t=this.patient_info.picture;console.log("所有照片信息",t);for(var e=[],i=[],a=t[0].own_to,n=0;n<t.length;n++)if(console.log(t[n].pic_name),t[n].own_to===a)if(-1!==t[n].pic_name.search("left")){var o=E+"media/"+t[n].hospital+"/"+t[n].pic_name;e.push(o)}else{var r=E+"media/"+t[n].hospital+"/"+t[n].pic_name;i.push(r)}console.log(i,e),this.left_src=e[0],this.right_src=i[0],this.left_srcList=e,this.right_srcList=i}catch(t){console.log(t)}this.getConclusion()}},N={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-container",[i("el-aside",{staticClass:"aside",attrs:{id:"aside_id"}},[i("el-row",{staticStyle:{"text-align":"left",height:"40px","line-height":"40px"},style:{backgroundColor:t.activeColor2}},[i("i",{staticClass:"icon iconfont icon-icon-test"}),t._v("单击可将词条插入诊断内容\n  ")]),t._v(" "),i("el-row",{staticStyle:{"margin-top":"20px"}},[i("el-autocomplete",{attrs:{"fetch-suggestions":t.querySearchAsync,placeholder:"可模糊搜索疑似病种","prefix-icon":"el-icon-search"},on:{select:t.handleSelect},model:{value:t.state,callback:function(e){t.state=e},expression:"state"}})],1),t._v(" "),i("el-row",{staticStyle:{height:"40px","line-height":"40px","text-align":"left","margin-top":"20px"},style:{backgroundColor:t.activeColor1}},[t._v("\n    建议\n  ")]),t._v(" "),t._l(t.suggestions,function(e){return i("el-row",{key:e.id,staticClass:"suggestion_section"},[i("el-col",{attrs:{span:3}},[t._v(" ")]),t._v(" "),i("el-col",{attrs:{span:18}},[i("a",{attrs:{href:"javascript:;"},on:{click:function(i){return t.addAdvice(e)}}},[i("div",{staticStyle:{border:"1px solid lightgrey",height:"30px","line-height":"30px","border-radius":"20px"}},[t._v(t._s(e))])])]),t._v(" "),i("el-col",{attrs:{span:3}},[t._v(" ")])],1)}),t._v(" "),i("el-row",{staticStyle:{height:"40px","line-height":"40px","text-align":"left","margin-top":"20px","background-color":"azure"},style:{backgroundColor:t.activeColor2}},[t._v("\n    疑似\n  ")]),t._v(" "),t._l(t.diseases,function(e){return i("el-row",{key:e.id,staticClass:"diseases_section"},[i("el-col",{attrs:{span:3}},[t._v(" ")]),t._v(" "),i("el-col",{attrs:{span:18}},[i("a",{attrs:{href:"javascript:;"},on:{click:function(i){return t.addDiagnose(e)}}},[i("div",{staticStyle:{border:"1px solid lightgrey",height:"30px","line-height":"30px","border-radius":"20px"}},[t._v(t._s(e))])])]),t._v(" "),i("el-col",{attrs:{span:3}},[t._v(" ")])],1)})],2),t._v(" "),i("el-main",{staticClass:"main"},[i("el-row",[i("span",[t._v("合肥高新区天乐社区卫生服务中心")])]),t._v(" "),i("el-row",{staticStyle:{"margin-top":"20px",height:"40px","line-height":"40px"}},[i("el-col",{attrs:{span:4}},[t._v(" ")]),t._v(" "),i("el-col",{staticStyle:{"border-top":"lightgrey 1px solid","border-bottom":"lightgrey 1px solid","text-align":"left"},attrs:{span:16}},[i("el-row",[i("el-col",{attrs:{span:6}},[t._v("姓名:"),i("span",[t._v(t._s(t.patient_info.patient_name))])]),t._v(" "),i("el-col",{attrs:{span:6}},[t._v("性别:"),"0"===t.patient_info.patient_gender?i("span",[t._v("女")]):i("span",[t._v("男")])]),t._v(" "),i("el-col",{attrs:{span:6}},[t._v("年龄:"),i("span",[t._v(t._s(t.patient_info.patient_age))])]),t._v(" "),i("el-col",{attrs:{span:6}},[t._v("患者编号:")])],1)],1),t._v(" "),i("el-col",{staticStyle:{border:"1px solid white"},attrs:{span:4}},[t._v(" ")])],1),t._v(" "),i("el-row",{staticStyle:{"margin-top":"20px"}},[i("el-col",{attrs:{span:4}},[t._v(" ")]),t._v(" "),i("el-col",{attrs:{span:16}},[i("el-row",{staticStyle:{"text-align":"left","font-weight":"bold"}},[i("el-col",{attrs:{span:11}},[t._v("右眼OD")]),t._v(" "),i("el-col",{attrs:{span:2}},[t._v(" ")]),t._v(" "),i("el-col",{attrs:{span:11}},[t._v("左眼OS")])],1)],1),t._v(" "),i("el-col",{attrs:{span:4}},[t._v(" ")])],1),t._v(" "),i("el-row",{staticStyle:{"margin-top":"20px"}},[i("el-col",{attrs:{span:4}},[t._v(" ")]),t._v(" "),i("el-col",{attrs:{span:16}},[i("el-row",{staticStyle:{"text-align":"left","font-weight":"bold"}},[i("el-col",{attrs:{span:11}},[i("div",{staticClass:"demo-image__preview"},[i("el-image",{staticStyle:{height:"300px"},attrs:{src:t.right_src,"preview-src-list":t.right_srcList}})],1)]),t._v(" "),i("el-col",{attrs:{span:2}},[t._v(" ")]),t._v(" "),i("el-col",{attrs:{span:11}},[i("div",{staticClass:"demo-image__preview"},[i("el-image",{staticStyle:{height:"300px"},attrs:{src:t.left_src,"preview-src-list":t.left_srcList}})],1)])],1)],1),t._v(" "),i("el-col",{attrs:{span:4}},[t._v(" ")])],1),t._v(" "),i("el-row",{staticStyle:{"text-align":"left"}},[i("el-col",{attrs:{span:4}},[t._v(" ")]),t._v(" "),i("el-col",{attrs:{span:16}},[i("span",[t._v("影像发现:")])]),t._v(" "),i("el-col",{attrs:{span:4}},[t._v(" ")])],1),t._v(" "),i("el-row",{staticStyle:{"text-align":"left","margin-top":"10px"}},[i("el-col",{attrs:{span:4}},[t._v(" ")]),t._v(" "),i("el-col",{attrs:{span:16}},[i("el-row",{staticStyle:{"border-top":"1px solid lightgray"}},[i("el-col",{attrs:{span:6}},[t._v("类别")]),t._v(" "),i("el-col",{attrs:{span:6}},[t._v("数量(个)")]),t._v(" "),i("el-col",{attrs:{span:6}},[t._v("总面积")]),t._v(" "),i("el-col",{attrs:{span:6}},[t._v("最大面积mm"),i("sup",[t._v("2")])])],1)],1),t._v(" "),i("el-col",{attrs:{span:4}},[t._v(" ")])],1),t._v(" "),i("el-row",{staticClass:"dataTable",staticStyle:{"text-align":"left"}},[i("el-col",{attrs:{span:4}},[t._v(" ")]),t._v(" "),i("el-col",{attrs:{span:16}},[i("el-row",[i("el-col",{attrs:{span:6}},[t._v("出血")]),t._v(" "),i("el-col",{attrs:{span:6}},[t._v("--")]),t._v(" "),i("el-col",{attrs:{span:6}},[t._v("--")]),t._v(" "),i("el-col",{attrs:{span:6}},[t._v("--")])],1)],1),t._v(" "),i("el-col",{attrs:{span:4}},[t._v(" ")])],1),t._v(" "),i("el-row",{staticClass:"dataTable",staticStyle:{"text-align":"left"}},[i("el-col",{attrs:{span:4}},[t._v(" ")]),t._v(" "),i("el-col",{attrs:{span:16}},[i("el-row",{staticStyle:{"border-bottom":"1px solid lightgray"}},[i("el-col",{attrs:{span:6}},[t._v("渗出")]),t._v(" "),i("el-col",{attrs:{span:6}},[t._v("--")]),t._v(" "),i("el-col",{attrs:{span:6}},[t._v("--")]),t._v(" "),i("el-col",{attrs:{span:6}},[t._v("--")])],1)],1),t._v(" "),i("el-col",{attrs:{span:4}},[t._v(" ")])],1),t._v(" "),i("el-row",{staticStyle:{"text-align":"left","margin-top":"20px"}},[i("el-col",{attrs:{span:4}},[t._v(" ")]),t._v(" "),i("el-col",{attrs:{span:16}},[i("span",[t._v("诊断:")])]),t._v(" "),i("el-col",{attrs:{span:4}},[t._v(" ")])],1),t._v(" "),t.diaSeen?i("el-row",{staticStyle:{"text-align":"left","margin-top":"10px"}},[i("el-col",{attrs:{span:4}},[t._v(" ")]),t._v(" "),i("el-col",{attrs:{span:16}},[t._v("右眼:\n        "),t._l(t.dynamicTagsR,function(e){return i("el-tag",{key:e,attrs:{closable:"","disable-transitions":!1,type:"info",effect:"plain"},on:{close:function(i){return t.handleCloseR(e)}}},[t._v("\n          "+t._s(e)+"\n        ")])}),t._v(" "),t.inputVisibleR?i("el-input",{ref:"saveTagInputR",staticClass:"input-new-tag",attrs:{size:"small"},on:{blur:t.handleInputConfirmR},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleInputConfirmR(e)}},model:{value:t.inputValueR,callback:function(e){t.inputValueR=e},expression:"inputValueR"}}):i("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:t.showInputR}},[t._v("+ 添加诊断")])],2),t._v(" "),i("el-col",{attrs:{span:4}},[t._v(" ")])],1):t._e(),t._v(" "),t.diaSeen?i("el-row",{staticStyle:{"text-align":"left","margin-top":"10px"}},[i("el-col",{attrs:{span:4}},[t._v(" ")]),t._v(" "),i("el-col",{attrs:{span:16}},[t._v("左眼:\n        "),t._l(t.dynamicTagsL,function(e){return i("el-tag",{key:e,attrs:{closable:"","disable-transitions":!1,effect:"plain",type:"info"},on:{close:function(i){return t.handleCloseL(e)}}},[t._v("\n          "+t._s(e)+"\n        ")])}),t._v(" "),t.inputVisibleL?i("el-input",{ref:"saveTagInputL",staticClass:"input-new-tag",attrs:{size:"small"},on:{blur:t.handleInputConfirmL},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleInputConfirmL(e)}},model:{value:t.inputValueL,callback:function(e){t.inputValueL=e},expression:"inputValueL"}}):i("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:t.showInputL}},[t._v("+ 添加诊断")])],2),t._v(" "),i("el-col",{attrs:{span:4}},[t._v(" ")])],1):t._e(),t._v(" "),t.eyeSeen?i("el-row",{staticStyle:{"text-align":"left","margin-top":"10px"}},[i("el-col",{attrs:{span:4}},[t._v(" ")]),t._v(" "),i("el-col",{attrs:{span:16}},[t._v("右眼:"+t._s(t.diaStrR))]),t._v(" "),i("el-col",{attrs:{span:4}},[t._v(" ")])],1):t._e(),t._v(" "),t.eyeSeen?i("el-row",{staticStyle:{"text-align":"left","margin-top":"10px"}},[i("el-col",{attrs:{span:4}},[t._v(" ")]),t._v(" "),i("el-col",{attrs:{span:16}},[t._v("左眼:"+t._s(t.diaStrL))]),t._v(" "),i("el-col",{attrs:{span:4}},[t._v(" ")])],1):t._e(),t._v(" "),t.diaSeen?i("el-row",{staticStyle:{"text-align":"left","margin-top":"20px"}},[i("el-col",{attrs:{span:4}},[t._v(" ")]),t._v(" "),i("el-col",{attrs:{span:16}},[i("span",[t._v("建议:\n       "),t._l(t.dynamicTagsA,function(e){return i("el-tag",{key:e,attrs:{closable:"","disable-transitions":!1,type:"info",effect:"plain"},on:{close:function(i){return t.handleCloseA(e)}}},[t._v("\n          "+t._s(e)+"\n        ")])}),t._v(" "),t.inputVisibleA?i("el-input",{ref:"saveTagInputA",staticClass:"input-new-tag",attrs:{size:"small"},on:{blur:t.handleInputConfirmA},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleInputConfirmA(e)}},model:{value:t.inputValueA,callback:function(e){t.inputValueA=e},expression:"inputValueA"}}):t._e(),t._v(" "),t.seen?i("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:t.showInputA}},[t._v("+ 添加建议")]):t._e(),t._v("\n           "),t.seen2?i("span",[t._v("日期:")]):t._e(),t._v(t._s(t.value2)+"\n      ")],2)]),t._v(" "),i("el-col",{attrs:{span:4}},[t._v(" ")])],1):t._e(),t._v(" "),t.eyeSeen?i("el-row",{staticStyle:{"text-align":"left","margin-top":"20px"}},[i("el-col",{attrs:{span:4}},[t._v(" ")]),t._v(" "),i("el-col",{attrs:{span:16}},[i("span",[t._v("建议:"+t._s(t.dynamicTagsA[0])+"\n\n           "),t.seen2?i("span",[t._v("日期:")]):t._e(),t._v(t._s(t.value2)+"\n      ")])]),t._v(" "),i("el-col",{attrs:{span:4}},[t._v(" ")])],1):t._e(),t._v(" "),t.beforeSeen?i("el-row",{staticStyle:{"margin-top":"20px",height:"40px","line-height":"40px"}},[i("el-col",{attrs:{span:4}},[t._v(" ")]),t._v(" "),i("el-col",{staticStyle:{"text-align":"left",height:"60px","line-height":"60px","border-top":"1px solid lightgray","border-bottom":"1px solid lightgray"},attrs:{span:16}},[i("el-row",[i("el-col",{attrs:{span:8}},[i("el-button",{on:{click:t.openFullScreen}},[t._v("完成阅片")])],1),t._v(" "),i("el-col",{attrs:{span:8}},[i("el-button",{on:{click:t.backToUndiagnosed}},[t._v("完成并返回")])],1),t._v(" "),i("el-col",{attrs:{span:8}},[i("el-button",{on:{click:t.finishAndCreatePdf}},[t._v("完成并生成报告")])],1)],1)],1),t._v(" "),i("el-col",{attrs:{span:4}})],1):t._e(),t._v(" "),t.finishSeen?i("el-row",{staticStyle:{"margin-top":"20px",height:"40px","line-height":"40px"}},[i("el-col",{attrs:{span:4}},[t._v(" ")]),t._v(" "),i("el-col",{staticStyle:{"text-align":"left",height:"60px","line-height":"60px","border-top":"1px solid lightgray","border-bottom":"1px solid lightgray"},attrs:{span:16}},[i("el-row",[i("el-col",{attrs:{span:8}},[i("el-button",{on:{click:t.onlyBack}},[t._v("返回")])],1),t._v(" "),i("el-col",{attrs:{span:8}},[i("el-button",{on:{click:t.createReport}},[t._v("生成报告")])],1),t._v(" "),i("el-col",{attrs:{span:8}},[t._v(" ")])],1)],1),t._v(" "),i("el-col",{attrs:{span:4}})],1):t._e()],1),t._v(" "),i("el-dialog",{attrs:{title:"请输入去上级医院就诊时间",visible:t.dialogVisible,width:"30%"},on:{"update:visible":function(e){t.dialogVisible=e}}},[i("div",{staticClass:"block"},[i("el-date-picker",{attrs:{align:"right",type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期","picker-options":t.pickerOptions},model:{value:t.value2,callback:function(e){t.value2=e},expression:"value2"}})],1),t._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:t.cancelSelectDate}},[t._v("取 消")]),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:t.confirmSelectDate}},[t._v("确 定")])],1)]),t._v(" "),i("el-dialog",{attrs:{title:"提示",visible:t.centerDialogVisible,width:"30%",center:""},on:{"update:visible":function(e){t.centerDialogVisible=e}}},[i("span",[t._v("生成报告失败")]),t._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"primary"},on:{click:function(e){t.centerDialogVisible=!1}}},[t._v("确 定")])],1)])],1)},staticRenderFns:[]};var B=i("VU/8")(O,N,!1,function(t){i("Z0Zb")},"data-v-4e5da3c7",null).exports,I=w.a.url,H={data:function(){return{userName:"",parseWord:"",autoLogin:!1,error:!1,userNameError:"",parseWordError:"",hospital_id:0}},methods:{get_hospital_id:function(t){_.a.get(I+"/users/?username="+t).then(function(t){console.log("hospital_id",t.data[0].hospital_id),y.a.setCookie("hospital_id",t.data[0].hospital_id,7),console.log("get id from cookie",y.a.getCookie("hospital_id"))}).catch(function(t){console.log(t)})},login:function(){var t=this,e=this;if(""!==this.userName)if(""!==this.parseWord){console.log("123",this.userName,this.parseWord);try{this.get_hospital_id(this.userName)}catch(t){console.log("the reason of failing to get hospital_id ",t)}Object(b.f)({username:this.userName,password:this.parseWord}).then(function(i){console.log(i),y.a.setCookie("name",t.userName,7),y.a.setCookie("token",i.token,7),e.$store.commit("setInfo"),e.$store.commit("login")}).catch(function(t){e.error="请核实账户或密码是否正确","non_field_errors"in t&&(e.error=t.non_field_errors[0]),"username"in t&&(e.userNameError=t.username[0]),"password"in t&&(e.parseWordError=t.password[0])})}else e.error="请输入密码";else e.error="请输入用户名"},errorUnshow:function(){this.error=!1}},mounted:function(){var t=window.innerHeight;document.getElementById("login").style.height=t+"px"}},M={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"c-box bg-box",attrs:{id:"login"}},[i("div",{staticClass:"login-box clearfix",staticStyle:{"margin-top":"10px"}},[i("div",{staticClass:"fr form-box"},[i("h2",[t._v("帐号登录")]),t._v(" "),i("form",{attrs:{id:"jsLoginForm",autocomplete:"off"}},[i("input",{attrs:{type:"hidden",name:"csrfmiddlewaretoken",value:"ywSlOHdiGsK6VFB6iyhnB1B30khmz8SU"}}),t._v(" "),i("div",{staticClass:"form-group marb20"},[i("label",[t._v("用 户 名")]),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.userName,expression:"userName"}],attrs:{name:"account_l",id:"account_l",type:"text",placeholder:"手机号/账号"},domProps:{value:t.userName},on:{focus:t.errorUnshow,input:function(e){e.target.composing||(t.userName=e.target.value)}}})]),t._v(" "),i("p",{directives:[{name:"show",rawName:"v-show",value:t.userNameError,expression:"userNameError"}],staticClass:"error-text"},[t._v(t._s(t.userNameError))]),t._v(" "),i("div",{staticClass:"form-group marb8"},[i("label",[t._v("密     码")]),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.parseWord,expression:"parseWord"}],attrs:{name:"password_l",id:"password_l",type:"password",placeholder:"请输入您的密码"},domProps:{value:t.parseWord},on:{focus:t.errorUnshow,input:function(e){e.target.composing||(t.parseWord=e.target.value)}}})]),t._v(" "),i("p",{directives:[{name:"show",rawName:"v-show",value:t.parseWordError,expression:"parseWordError"}],staticClass:"error-text"},[t._v(t._s(t.parseWordError))]),t._v(" "),i("div",{staticClass:"auto-box marb38"}),t._v(" "),i("p",{directives:[{name:"show",rawName:"v-show",value:t.error,expression:"error"}],staticClass:"error-text"},[t._v(t._s(t.error))]),t._v(" "),i("input",{staticClass:"btn btn-green",staticStyle:{outline:"none"},attrs:{id:"jsLoginBtn",type:"button",value:"立即登录 > "},on:{click:t.login}})])])])])])},staticRenderFns:[]};var J=i("VU/8")(H,M,!1,function(t){i("lvCu")},"data-v-34bcc16c",null).exports;window.onresize=function(){var t=window.innerWidth-250,e=window.innerHeight;document.getElementById("rightNav").style.width=t+"px",document.getElementById("leftNav").style.height=e+"px"};var q={name:"App",created:function(){y.a.getCookie("token")?this.$store.commit("login"):this.$store.commit("logout")},mounted:function(){var t=window.innerWidth-250;console.log(t),document.getElementById("rightNav").style.width=t+"px"},components:{leftNav:s,topHeader:u,undiagnosed:h,diagnosed:S,transform:T,statistics:z,report:B,login:J},data:function(){return{seen:!1,msg:"Hello Vuex"}},store:n.a},W={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"app"}},[t.$store.state.login?i("login"):t._e(),t._v(" "),t.$store.state.leftNav?i("leftNav",{staticClass:"leftNav",attrs:{id:"leftNav"}}):t._e(),t._v(" "),t.$store.state.leftNav?i("div",{staticClass:"main",attrs:{id:"rightNav"}},[i("router-view"),t._v(" "),t.$store.state.topHeader?i("topHeader"):t._e(),t._v(" "),t.$store.state.undiagnosed?i("undiagnosed"):t._e(),t._v(" "),t.$store.state.diagnosed?i("diagnosed"):t._e(),t._v(" "),t.$store.state.transform?i("transform"):t._e(),t._v(" "),t.$store.state.statistics?i("statistics"):t._e(),t._v(" "),t.$store.state.report?i("report"):t._e()],1):t._e()],1)},staticRenderFns:[]};var U=i("VU/8")(q,W,!1,function(t){i("rfvc")},null,null).exports,X=i("/ocq"),Z={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"hello"},[i("h1",[t._v(t._s(t.msg))]),t._v(" "),i("h2",[t._v("Essential Links")]),t._v(" "),t._m(0),t._v(" "),i("h2",[t._v("Ecosystem")]),t._v(" "),t._m(1)])},staticRenderFns:[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("ul",[i("li",[i("a",{attrs:{href:"https://vuejs.org",target:"_blank"}},[t._v("\n        Core Docs\n      ")])]),t._v(" "),i("li",[i("a",{attrs:{href:"https://forum.vuejs.org",target:"_blank"}},[t._v("\n        Forum\n      ")])]),t._v(" "),i("li",[i("a",{attrs:{href:"https://chat.vuejs.org",target:"_blank"}},[t._v("\n        Community Chat\n      ")])]),t._v(" "),i("li",[i("a",{attrs:{href:"https://twitter.com/vuejs",target:"_blank"}},[t._v("\n        Twitter\n      ")])]),t._v(" "),i("br"),t._v(" "),i("li",[i("a",{attrs:{href:"http://vuejs-templates.github.io/webpack/",target:"_blank"}},[t._v("\n        Docs for This Template\n      ")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[e("a",{attrs:{href:"http://router.vuejs.org/",target:"_blank"}},[this._v("\n        vue-router\n      ")])]),this._v(" "),e("li",[e("a",{attrs:{href:"http://vuex.vuejs.org/",target:"_blank"}},[this._v("\n        vuex\n      ")])]),this._v(" "),e("li",[e("a",{attrs:{href:"http://vue-loader.vuejs.org/",target:"_blank"}},[this._v("\n        vue-loader\n      ")])]),this._v(" "),e("li",[e("a",{attrs:{href:"https://github.com/vuejs/awesome-vue",target:"_blank"}},[this._v("\n        awesome-vue\n      ")])])])}]};i("VU/8")({name:"HelloWorld",data:function(){return{msg:"Welcome to Your Vue.js App"}}},Z,!1,function(t){i("UPVZ")},"data-v-1875956a",null).exports;a.default.use(X.a);var G=new X.a({routes:[]}),Y=i("zL8q"),K=i.n(Y);i("tvR6"),i("qqHy");a.default.config.productionTip=!1,a.default.use(K.a),new a.default({el:"#app",router:G,components:{App:U},template:"<App/>"})},O2WP:function(t,e,i){"use strict";e.a={url:"http://192.168.0.151:7000/"}},OidG:function(t,e){},P9l9:function(t,e,i){"use strict";var a=i("mtWM"),n=i.n(a),o=i("mvHQ"),r=i.n(o),s=i("Dd8w"),l=i.n(s),c=i("//Fk"),u=i.n(c),d=i("u4WU"),p=i("7+uW"),m=i("O2WP"),h=m.a.url,g=new p.default,v=n.a.create({baseURL:h,timeout:5e3});v.interceptors.request.use(function(t){var e=d.a.getCookie("token");return console.log("拦截中",e),null===e?(g.$message("登陆过期,即将返回登陆页面"),setTimeout("window.location.reload()",2e3),u.a.reject(error)):("post"===t.method?t.data=l()({},t.data):t.params=l()({},t.params),t.headers["Content-Type"]="application/x-www-form-urlencoded",t)},function(t){return g.$message(t),u.a.reject(t)}),v.interceptors.response.use(function(t){return console.log(t.data),t.data,t.data},function(t){console.log("error"),console.log(t),console.log(r()(t));var e=404===r()(t).status?"404":"操作异常";return console.log(e),u.a.reject(t)});var f=v;i.d(e,"f",function(){return b}),i.d(e,"h",function(){return y}),i.d(e,"b",function(){return w}),i.d(e,"g",function(){return x}),i.d(e,"d",function(){return F}),i.d(e,"e",function(){return k}),i.d(e,"a",function(){return S}),i.d(e,"c",function(){return V});var _=m.a.url,b=function(t){return n.a.post(_+"login",t).then(function(t){return t.data})},y=function(t){return n.a.post(_+"operation/sendSms/",t).then(function(t){return t.data})},w=function(t){return f({url:"operation/check/",method:"post",data:t})},x=function(t){return f({url:"operation/remove/",method:"post",data:t})},F=function(t){return f({url:"operation/editBasicInfo/",method:"post",data:t})},k=function(t){return f({url:"operation/editReviewInfo/",method:"post",data:t})},S=function(t){return f({url:"operation/add/",method:"post",data:t})},V=function(t){return f({url:"operation/clickDiagnoseButton/",method:"post",data:t})}},UPVZ:function(t,e){},YtJ0:function(t,e,i){"use strict";var a=i("7+uW"),n=i("2bvH"),o=i("u4WU");a.default.use(n.a);var r={clickUndiagnosed:function(t){t.undiagnosed=!0,t.diagnosed=!1,t.transform=!1,t.statistics=!1,t.report=!1},clickDiagnosed:function(t){t.undiagnosed=!1,t.diagnosed=!0,t.transform=!1,t.statistics=!1,t.report=!1},clickStatistics:function(t){t.undiagnosed=!1,t.diagnosed=!1,t.transform=!1,t.report=!1,t.statistics=!0},clickTransform:function(t){t.undiagnosed=!1,t.diagnosed=!1,t.transform=!0,t.statistics=!1,t.report=!1},clickReport:function(t,e){t.undiagnosed=!1,t.diagnosed=!1,t.transform=!1,t.statistics=!1,t.report=!0,t.patient_info=e},backToUndiagnosed:function(t){t.undiagnosed=!0,t.diagnosed=!1,t.transform=!1,t.statistics=!1,t.report=!1},rememberPageAndSize:function(t,e){t.page_info=e},setInfo:function(t){t.user_info={name:o.a.getCookie("name"),token:o.a.getCookie("token")}},saveHospitalId:function(t,e){t.hospital_id=e,console.log("state.hospital",e)},login:function(t){t.undiagnosed=!0,t.diagnosed=!1,t.transform=!1,t.statistics=!1,t.report=!1,t.leftNav=!0,t.topHeader=!0,t.login=!1,t.user_info={name:o.a.getCookie("name"),token:o.a.getCookie("token")}},logout:function(t){t.undiagnosed=!1,t.diagnosed=!1,t.transform=!1,t.statistics=!1,t.report=!1,t.leftNav=!1,t.topHeader=!1,t.login=!0,t.page_info={currentPage:1,page_size:10},o.a.delCookie("token"),o.a.delCookie("name"),o.a.delCookie("hospital_id"),t.user_info={name:o.a.getCookie("name"),token:o.a.getCookie("token")}}};e.a=new n.a.Store({state:{patient_info:{},page_info:{},user_info:{},undiagnosed:!1,diagnosed:!1,transform:!1,statistics:!1,report:!1,leftNav:!1,topHeader:!1,login:!0,hospital_id:0},mutations:r})},Z0Zb:function(t,e){},bvOk:function(t,e){},lvCu:function(t,e){},rfvc:function(t,e){},tvR6:function(t,e){},u4WU:function(t,e,i){"use strict";var a={setCookie:function(t,e,i){var a=new Date;a.setTime(a.getTime()+i),a.setDate(a.getDate()+i),document.cookie=t+"="+escape(e)+(null==i?"":";expires="+a.toGMTString())},getCookie:function(t){var e,i=new RegExp("(^| )"+t+"=([^;]*)(;|$)");return(e=document.cookie.match(i))?e[2]:null},delCookie:function(t){var e=new Date;e.setTime(e.getTime()-1),null!=a.getCookie(t)&&(document.cookie=t+"=; expires=Thu, 01 Jan 1970 00:00:01 GMT;"),console.log("delete successfully")}};e.a=a},yKzQ:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.1555b3d79d251d31de85.js.map